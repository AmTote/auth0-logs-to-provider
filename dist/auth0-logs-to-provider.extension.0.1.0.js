module.exports=function(e){function t(n){if(r[n])return r[n].exports;var o=r[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,t),o.l=!0,o.exports}var r={};return t.m=e,t.c=r,t.i=function(e){return e},t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=68)}([function(e,t,r){"use strict";e.exports=r(2).config()},function(e,t,r){"use strict";var n=r(22);n.emitErrs=!0;var o=new n.Logger({transports:[new n.transports.Console({timestamp:!0,level:"debug",handleExceptions:!0,json:!1,colorize:!0})],exitOnError:!1});e.exports=o,e.exports.stream={write:function(e){o.info(e.replace(/\n$/,""))}}},function(e,t){e.exports=require("auth0-extension-tools@1.3.1")},function(e,t,r){e.exports={default:r(72),__esModule:!0}},function(e,t){e.exports=require("auth0-log-extension-tools@1.3.6")},function(e,t){e.exports=require("util")},function(e,t,r){const n=r(50),o=r(23),i=r(43),s=r(49);e.exports.createServer=n.createServer,e.exports.urlHelpers=o,e.exports.middlewares=i,e.exports.routes=s},function(e,t){e.exports=require("async@2.1.2")},function(e,t){e.exports=require("express@4.12.4")},function(e,t){var r=e.exports={version:"2.5.5"};"number"==typeof __e&&(__e=r)},function(e,t){e.exports=require("lodash@4.8.2")},function(e,t){e.exports=require("moment@2.10.3")},function(e,t){e.exports=require("request@2.56.0")},function(e,t){e.exports=require("url")},function(e,t,r){e.exports=!r(15)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(e,t){e.exports=function(e){try{return!!e()}catch(e){return!0}}},function(e,t){var r=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=r)},function(e,t){e.exports=function(e){return"object"==typeof e?null!==e:"function"==typeof e}},function(e,t,r){var n=t;n.version=r(101).version,n.createClient=r(31).createClient,n.serialize=r(19).serialize,n.Loggly=r(31).Loggly,n.Search=r(32).Search},function(e,t,r){var n=(r(35),r(5),r(12)),o=(r(18),t),i=o.failCodes={400:"Bad Request",401:"Unauthorized",403:"Forbidden",404:"Not Found",409:"Conflict / Duplicate",410:"Gone",500:"Internal Server Error",501:"Not Implemented",503:"Throttled"};o.successCodes={200:"OK",201:"Created",202:"Accepted",203:"Non-authoritative information",204:"Deleted"};o.loggly=function(){function e(e){t||(t=!0,f&&f(e))}var t,r,o,s,a,u,c,l=Array.prototype.slice.call(arguments),p=l.pop(),f=l.pop();1===l.length?"string"==typeof l[0]?(s="GET",c=l[0]):(s=l[0].method||"GET",c=l[0].uri,r=l[0].body,a=l[0].auth,o=l[0].headers,u=l[0].proxy):2===l.length?(s="GET",c=l[0],a=l[1]):(s=l[0],c=l[1],a=l[2]);var d={uri:c,method:s,headers:o||{},proxy:u};a&&(d.headers.authorization="Basic "+new Buffer(a.username+":"+a.password).toString("base64")),r&&(d.body=r);try{n(d,function(t,r,n){if(t)return e(t);var o=r.statusCode.toString();if(-1!==Object.keys(i).indexOf(o))return e(new Error("Loggly Error ("+o+"): "+i[o]));p(r,n)})}catch(t){e(t)}},o.serialize=function(e,t){if(null===e?e="null":void 0===e?e="undefined":!1===e&&(e="false"),"object"!=typeof e)return t?t+"="+e:e;for(var r="",n=Object.keys(e),i=n.length,s=0;s<i;s++){if(Array.isArray(e[n[s]])){r+=n[s]+"=[";for(var a=0,u=e[n[s]].length;a<u;a++)r+=o.serialize(e[n[s]][a]),a<u-1&&(r+=", ");r+="]"}else r+=o.serialize(e[n[s]],n[s]);s<i-1&&(r+=", ")}return r},o.clone=function(e){var t={};for(var r in e)t[r]=e[r]instanceof Object?o.clone(e[r]):e[r];return t}},function(e,t,r){"use strict";var n=t;n.version=r(102).version,n.createClient=r(106).createClient},function(e,t){e.exports=require("events")},function(e,t){e.exports=require("winston@1.0.0")},function(e,t,r){function n(e){if(!e.container)return null;const t=e.container.replace(c,"\\$&"),r=e.jtn?e.jtn.replace(c,"\\$&"):"";if(e.url_format===u)return new RegExp("^/api/run/"+t+"/(?:"+r+"/?)?");if(e.url_format===a)return new RegExp("^/"+t+"/(?:"+r+"/?)?");if(e.url_format===s)return new RegExp("^/(?:"+r+"/?)?");throw new Error("Unsupported webtask URL format.")}function o(e,t){if(!e)return null;const r=e.indexOf("sandbox8")>=0?"8":"";return"https://"+t+"."+(e.split(".it.auth0.com")[0].split("-")[1]||"us")+r+".webtask.io/"}const i=r(13),s=3,a=2,u=1,c=/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,l=function(e,t){var r=i.parse(e).pathname||"";return r=r.replace(t,"").replace(/^\/|\/$/g,""),r.startsWith("/")||(r="/"+r),r.endsWith("/")||(r+="/"),r};e.exports.getBasePath=function(e){return l(e.originalUrl||"",e.path)},e.exports.getBaseUrl=function(e,t){var r=t;const n=i.parse(e.originalUrl||"").pathname||"";return i.format({protocol:r||"https",host:e.headers.host,pathname:n.replace(e.path,"").replace(/\/$/g,"")})},e.exports.getWebtaskUrl=function(e){const t=n(e.x_wt),r=e.url,s=e.url.replace(t,"/"),a=i.parse(s||"").pathname,u=e.x_wt&&e.x_wt.ectx&&e.x_wt.ectx.ISOLATED_DOMAIN||!1,c=i.parse(r||"").pathname||"";var l;if(u){l=i.format({protocol:"https",host:e.headers.host,pathname:c.replace(a,"").replace(/\/$/g,"")});const p=".it.auth0.com/api/run/"+e.x_wt.container+"/",f=o(l,e.x_wt.container);l.indexOf(p)>=0&&(l=l.replace("https://"+e.headers.host+"/api/run/"+e.x_wt.container+"/",f))}else l=c;return l}},function(e,t,r){"use strict";var n=r(108);e.exports=function(e,t,r){return function(o,i,s){var a=n(s);return!0===e||"function"==typeof e&&e(o,i,a)?t(o,i,a):r?r(o,i,a):a()}}},function(e,t){e.exports=function(e){if(void 0==e)throw TypeError("Can't call method on  "+e);return e}},function(e,t){var r={}.hasOwnProperty;e.exports=function(e,t){return r.call(e,t)}},function(e,t){var r=Math.ceil,n=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?n:r)(e)}},function(e,t,r){var n=r(84),o=r(25);e.exports=function(e){return n(o(e))}},function(e,t){function r(e,t,r,o){return JSON.stringify(e,n(t,o),r)}function n(e,t){var r=[],n=[];return null==t&&(t=function(e,t){return r[0]===t?"[Circular ~]":"[Circular ~."+n.slice(0,r.indexOf(t)).join(".")+"]"}),function(o,i){if(r.length>0){var s=r.indexOf(this);~s?r.splice(s+1):r.push(this),~s?n.splice(s,1/0,o):n.push(o),~r.indexOf(i)&&(i=t.call(this,o,i))}else r.push(i);return null==e?i:e.call(this,o,i)}}t=e.exports=r,t.getSerialize=n},function(e,t,r){"use strict";function n(e){this.message=e}var o=r(105);n.prototype=new Error,n.prototype.name="InvalidTokenError",e.exports=function(e,t){if("string"!=typeof e)throw new n("Invalid token specified");t=t||{};var r=!0===t.header?0:1;try{return JSON.parse(o(e.split(".")[r]))}catch(e){throw new n("Invalid token specified: "+e.message)}},e.exports.InvalidTokenError=n},function(e,t,r){function n(e){var t;try{t=JSON.stringify(e)}catch(r){t=l(e,null,null,o)}return t}function o(){}var i=r(21),s=r(5),a=(r(37),r(19)),u=r(18),c=r(32).Search,l=r(29);t.createClient=function(e){return new p(e)};var p=t.Loggly=function(e){if(!e||!e.subdomain||!e.token)throw new Error("options.subdomain and options.token are required.");i.EventEmitter.call(this),this.subdomain=e.subdomain,this.token=e.token,this.host=e.host||"logs-01.loggly.com",this.json=e.json||null,this.auth=e.auth||null,this.proxy=e.proxy||null,this.userAgent="node-loggly "+u.version,this.useTagHeader=!("useTagHeader"in e)||e.useTagHeader,this.tags=e.tags?this.tagFilter(e.tags):null;var t="https://"+this.host,r=e.api||"apiv2";this.urls={default:t,log:[t,"inputs",this.token].join("/"),bulk:[t,"bulk",this.token].join("/"),api:"https://"+[this.subdomain,"loggly","com"].join(".")+"/"+r}};s.inherits(p,i.EventEmitter),p.prototype.log=function(e,t,r){function o(e){return e instanceof Object?s.json?n(e):a.serialize(e):s.json?n({message:e}):e}r||"function"!=typeof t||(r=t,t=null);var i,s=this,u=Array.isArray(e);return e=u?e.map(o).join("\n"):o(e),i={uri:u?this.urls.bulk:this.urls.log,method:"POST",body:e,proxy:this.proxy,headers:{host:this.host,accept:"*/*","user-agent":this.userAgent,"content-type":this.json?"application/json":"text/plain","content-length":Buffer.byteLength(e)}},t=t?this.tags?this.tags.concat(this.tagFilter(t)):this.tagFilter(t):this.tags,t&&(this.useTagHeader?i.headers["X-LOGGLY-TAG"]=t.join(","):i.uri+="/tag/"+t.join(",")+"/"),a.loggly(i,r,function(e,t){try{var n=JSON.parse(t);s.emit("log",n),r&&r(null,n)}catch(e){r&&r(new Error("Unspecified error from Loggly: "+e))}}),this},p.prototype.tagFilter=function(e){var t=/^[\w\d][\w\d-_.]+/;return e=Array.isArray(e)?e:[e],e.filter(function(e){return t.test(e)&&e.length<=64})},p.prototype.customer=function(e){a.loggly({uri:this.logglyUrl("customer"),auth:this.auth},e,function(t,r){var n;try{n=JSON.parse(r)}catch(t){return e(t)}e(null,n)})},p.prototype.search=function(e,t){var r="string"==typeof e?{query:e}:e;return r.callback=t,new c(r,this)},p.prototype.logglyUrl=function(){var e=Array.prototype.slice.call(arguments);return[this.urls.api].concat(e).join("/")}},function(e,t,r){var n=r(21),o=r(5),i=r(37),s=r(111),a=r(19),u=t.Search=function(e,t){if(!e||!e.query&&!e.q)throw new Error("options.query is required to execute a Loggly search.");n.EventEmitter.call(this),e.query&&(e.q=e.query,delete e.query),this.options=e,this.client=t,e.callback&&(this.callback=e.callback,delete e.callback,this.run())};o.inherits(u,n.EventEmitter),u.prototype.run=function(e){function t(){n||(n=!0,o.callback.apply(null,arguments))}function r(e){if(!e||!e.id)return t(e);a.loggly({uri:o.client.logglyUrl("events?"+i.stringify({rsid:e.id})),auth:o.client.auth,json:!0},t,function(e,r){var n;try{n=JSON.parse(r)}catch(e){return t(e)}t(null,n)})}var n,o=this;if(this.options.q.trim(),this.callback=e||this.callback,!this.callback)throw new Error("Cannot run search without a callback function.");return this._checkRange(),a.loggly({uri:this.client.logglyUrl("search?"+i.stringify(this.options)),auth:this.client.auth,json:!0},this.callback,function(e,t){var n;try{n=JSON.parse(t).rsid}catch(e){n=e}o.emit("rsid",n),r(n)}),this},u.prototype._checkRange=function(){if(this.options.until||this.options.from)return this.options.until=this.options.until||"now",this.options.from=this.options.from||"-24h",s.parseDate(this.options.until)||(this.options.until="now"),s.parseDate(this.options.from)||(this.options.from="-24h"),(s.fromDates(this.options.from,this.options.until)<0||this.options.until===this.options.from)&&(this.options.until="now",this.options.from="-24h"),this}},function(e,t){var r={};r.formatTime=function(e){var t;return e instanceof Date&&(e=e.valueOf()),e&&null!==e?(-1!==e.toString().indexOf(".")?(t=parseFloat(e).toFixed(3),t.toString().indexOf(".")>=10&&(t=parseFloat(t.toString().substring(0,14)).toFixed(3))):t=13===e.toString().length?(parseFloat(e)/1e3).toFixed(3):e.toString().length<=12?parseFloat(e).toFixed(3):parseFloat(e.toString().substring(0,13)/1e3).toFixed(3),t):null},r.toArray=function(e){return Array.prototype.slice.call(e)},r.chain=function(e,t){if(arguments.length>1&&"function"==typeof arguments[0]){var n=r.toArray(arguments);e=n.slice(0,n.length-1),t=n[n.length-1]}if(e=e||[],t=t||function(){},0===e.length)t();else{var o=function(e,n,i){var s=function(e){if(e)t(e);else{var i=r.toArray(arguments);i.shift(),o(n[0],n.slice(1),i)}},a=i;0===n.length?a.push(t):a.push(s),e.apply(null,a)};o(e[0],e.slice(1),[])}},r.whilst=function(e,t,n){e=e||function(){return!1},t=t||function(e){e()},n=n||function(){};var o=function(o){o?n(o):r.whilst(e,t,n)};e()?t(o):n(null)},r.expBackoff=function(e,t){if(t=t||function(){},e&&"object"==typeof e)if(e&&!e.hasOwnProperty("attempt"))t(new Error("Must set opts.attempt."));else{var r=Math.random();e.hasOwnProperty("rand")&&(r=e.rand),r++;var n=Math.round(10*r*Math.pow(2,e.attempt));n=Math.min(n,12e4),setTimeout(function(){t(null,n)},n)}else t(new Error("Must send opts as an object."))},r.bind=function(e,t){return function(){return t.apply(e,arguments)}},r.copyObject=function(e){var t={};for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);return t},r.copyArray=function(e){for(var t=[],r=0;e&&r<e.length;r++)t[r]=e[r];return t},r.orByProp=function(e){for(var t=!1,r=1;!t&&r<arguments.length;r++)arguments[r]&&(t=t||arguments[r][e]);return t},r.orByFalseyProp=function(e){for(var t=null,r=arguments.length-1;r>0;r--)arguments[r]&&arguments[r].hasOwnProperty(e)&&(t=arguments[r][e]);return t},r.validateNonNegativeInt=function(e,t){if(e=parseInt(e,10),isNaN(e))throw new Error(t+" must be a number, found: "+e);if(e<0)throw new Error(t+" must be a positive number, found: "+e);return e},e.exports=r},function(e,t){e.exports=require("express-jwt@3.1.0")},function(e,t){e.exports=require("https")},function(e,t){e.exports=require("path")},function(e,t){e.exports=require("querystring")},function(e,t){e.exports=require("useragent@2.1.6")},function(e,t,r){"use strict";(function(t){var n=(r(13),r(36)),o=r(125),i=r(8),s=r(117),a=r(2),u=r(6),c=r(66),l=r(67),p=r(64),f=r(1),d=r(0),h=r(51);e.exports=function(e,r){d.setProvider(e);var g=r?new a.WebtaskStorageContext(r,{force:1}):new a.FileStorageContext(n.join(t,"./data.json"),{mergeWrites:!0}),m=new i;m.use(o(":method :url :status :response-time ms - :res[content-length]",{stream:f.stream}));var v=function(e){return function(t,r,n){return t.webtaskContext&&t.webtaskContext.body?(t.body=t.webtaskContext.body,n()):e(t,r,n)}};return m.use(v(s.json())),m.use(v(s.urlencoded({extended:!1}))),m.use(u.routes.dashboardAdmins({secret:d("EXTENSION_SECRET"),audience:"urn:logs-to-provider",rta:d("AUTH0_RTA").replace("https://",""),domain:d("AUTH0_DOMAIN"),baseUrl:d("PUBLIC_WT_URL")||d("WT_URL"),clientName:"Logs to Any Provider",urlPrefix:"",sessionStorageKey:"logs-to-provider:apiToken"})),m.use("/meta",l()),m.use("/.extensions",p()),m.use("/app",i.static(n.join(t,"../dist"))),m.use(h(g)),m.use("/",c(g)),m.use(u.middlewares.errorHandler(f.error.bind(f))),m}}).call(t,"/")},function(e,t,r){const n=r(30),o=r(34),i=r(2),s=r(24);e.exports=function(e){if(!e||"object"!=typeof e)throw new i.ArgumentError("Must provide the options");if(null===e.secret||void 0===e.secret)throw new i.ArgumentError("Must provide a valid secret");if("string"!=typeof e.secret||0===e.secret.length)throw new i.ArgumentError("The provided secret is invalid: "+e.secret);if(null===e.audience||void 0===e.audience)throw new i.ArgumentError("Must provide a valid secret");if("string"!=typeof e.audience||0===e.audience.length)throw new i.ArgumentError("The provided audience is invalid: "+e.audience);if(null===e.baseUrl||void 0===e.baseUrl)throw new i.ArgumentError("Must provide a valid base URL");if("string"!=typeof e.baseUrl||0===e.baseUrl.length)throw new i.ArgumentError("The provided base URL is invalid: "+e.baseUrl);const t=o({audience:e.audience,issuer:e.baseUrl,secret:e.secret,algorithms:["HS256"],credentialsRequired:e.credentialsRequired||!0});return function(r,n,o){t(r,n,function(t){return t?o(t):e.onLoginSuccess?e.onLoginSuccess(r,n,o):o()})}},e.exports.optional=function(t){const r=e.exports(t);return s(function(e){if(e&&e.headers&&e.headers.authorization&&0===e.headers.authorization.indexOf("Bearer "))try{const r=n(e.headers.authorization.split(" ")[1]);return r&&r.iss===t.baseUrl}catch(e){return!1}return!1},r)}},function(e,t,r){const n=r(30),o=r(34),i=r(123),s=r(2),a=r(24),u=r(2).UnauthorizedError;e.exports=function(e){if(!e||"object"!=typeof e)throw new s.ArgumentError("Must provide the options");if(null===e.domain||void 0===e.domain)throw new s.ArgumentError("Must provide a valid domain");if("string"!=typeof e.domain||0===e.domain.length)throw new s.ArgumentError("The provided domain is invalid: "+e.domain);if(null===e.audience||void 0===e.audience)throw new s.ArgumentError("Must provide a valid audience");if("string"!=typeof e.audience||0===e.audience.length)throw new s.ArgumentError("The provided audience is invalid: "+e.audience);const t=o({secret:i.expressJwtSecret({cache:!0,rateLimit:!0,jwksRequestsPerMinute:5,jwksUri:"https://"+e.domain+"/.well-known/jwks.json",handleSigningKeyError:function(e,t){return t(e instanceof i.SigningKeyNotFoundError?new u("A token was provided with an invalid kid"):e)}}),audience:e.audience,issuer:"https://"+e.domain+"/",algorithms:["RS256"],credentialsRequired:e&&e.credentialsRequired||!0});return function(r,n,o){t(r,n,function(t){return t?o(t):e.onLoginSuccess?e.onLoginSuccess(r,n,o):o()})}},e.exports.optional=function(t){const r=e.exports(t);return a(function(e){if(e&&e.headers&&e.headers.authorization&&0===e.headers.authorization.indexOf("Bearer "))try{const r=n(e.headers.authorization.split(" ")[1]);return r&&r.iss==="https://"+t.domain+"/"}catch(e){return!1}return!1},r)}},function(e,t,r){e.exports=function(e){return function(t,r,n,o){return e&&e(t),t&&t.status?(n.status(t.status),n.json({error:t.code||t.name,message:t.message||t.name})):(n.status(t.status||500),n.json({error:"InternalServerError",message:t.message||t.name}))}}},function(e,t,r){e.exports.authenticateAdmins=r(40),e.exports.authenticateUsers=r(41),e.exports.requireAuthentication=r(45),e.exports.errorHandler=r(42),e.exports.managementApiClient=r(44),e.exports.validateHookToken=r(46),e.exports.webtaskConfig=r(47)},function(e,t,r){const n=r(2);e.exports=function(e){return function(t,r,o){const i=t,s=t.user&&t.user.access_token&&t.user.access_token.length,a=s?{domain:e.domain,accessToken:t.user.access_token}:e;n.managementApi.getClient(a).then(function(e){return i.auth0=e,o(),null}).catch(function(e){o(e)})}}},function(e,t,r){const n=r(2).UnauthorizedError;e.exports=function(e,t,r){return e.user?r():r(new n("Authentication required for this endpoint."))}},function(e,t,r){const n=r(2);e.exports=function(e,t,r){if(null===e||void 0===e)throw new n.ArgumentError("Must provide the domain");if("string"!=typeof e||0===e.length)throw new n.ArgumentError("The provided domain is invalid: "+e);if(null===t||void 0===t)throw new n.ArgumentError("Must provide the webtaskUrl");if("string"!=typeof t||0===t.length)throw new n.ArgumentError("The provided webtaskUrl is invalid: "+t);if(null===r||void 0===r)throw new n.ArgumentError("Must provide the extensionSecret");if("string"!=typeof r||0===r.length)throw new n.ArgumentError("The provided extensionSecret is invalid: "+r);return function(o){if(null===o||void 0===o)throw new n.ArgumentError("Must provide the hookPath");if("string"!=typeof o||0===o.length)throw new n.ArgumentError("The provided hookPath is invalid: "+o);return function(i,s,a){if(i.headers.authorization&&"Bearer"===i.headers.authorization.split(" ")[0]){const u=i.headers.authorization.split(" ")[1];try{if(n.validateHookToken(e,t,o,r,u))return a()}catch(e){return a(e)}}return a(new n.HookTokenError("Hook token missing for the call to: "+o))}}}},function(e,t,r){const n=r(2);e.exports=function(e){return function(t,r,o){return t.webtaskContext&&e.setProvider(n.configProvider.fromWebtaskContext(t.webtaskContext)),o()}}},function(e,t,r){const n=r(8),o=r(119),i=r(70),s=r(122),a=r(2),u=r(23);e.exports=function(e){if(!e||"object"!=typeof e)throw new a.ArgumentError("Must provide the options");if(null===e.secret||void 0===e.secret)throw new a.ArgumentError("Must provide a valid secret");if("string"!=typeof e.secret||0===e.secret.length)throw new a.ArgumentError("The provided secret is invalid: "+e.secret);if(null===e.audience||void 0===e.audience)throw new a.ArgumentError("Must provide a valid audience");if("string"!=typeof e.audience||0===e.audience.length)throw new a.ArgumentError("The provided audience is invalid: "+e.audience);if(null===e.rta||void 0===e.rta)throw new a.ArgumentError("Must provide a valid rta");if("string"!=typeof e.rta||0===e.rta.length)throw new a.ArgumentError("The provided rta is invalid: "+e.rta);if(null===e.domain||void 0===e.domain)throw new a.ArgumentError("Must provide a valid domain");if("string"!=typeof e.domain||0===e.domain.length)throw new a.ArgumentError("The provided domain is invalid: "+e.domain);if(null===e.baseUrl||void 0===e.baseUrl)throw new a.ArgumentError("Must provide a valid base URL");if("string"!=typeof e.baseUrl||0===e.baseUrl.length)throw new a.ArgumentError("The provided base URL is invalid: "+e.baseUrl);if(null===e.clientName||void 0===e.clientName)throw new a.ArgumentError("Must provide a valid client name");if("string"!=typeof e.clientName||0===e.clientName.length)throw new a.ArgumentError("The provided client name is invalid: "+e.clientName);const t=e.stateKey||"state",r=e.nonceKey||"nonce",c=e.urlPrefix||"",l=e.sessionStorageKey||"apiToken",p=n.Router();return p.get(c+"/login",function(n,i){const s=o.randomBytes(16).toString("hex"),l=o.randomBytes(16).toString("hex");i.cookie(t,s),i.cookie(r,l);const p=new a.SessionManager(e.rta,e.domain,e.baseUrl),f=p.createAuthorizeUrl({redirectUri:u.getBaseUrl(n)+c+"/login/callback",scopes:e.scopes,expiration:e.expiration,nonce:l,state:s});i.redirect(f)}),p.post(c+"/login/callback",i(),function(n,o,i){var c;try{c=s.decode(n.body.id_token)}catch(e){c=null}return c&&n.cookies&&n.cookies[r]===c.nonce?n.cookies&&n.cookies[t]===n.body.state?new a.SessionManager(e.rta,e.domain,e.baseUrl).create(n.body.id_token,n.body.access_token,{secret:e.secret,issuer:e.baseUrl,audience:e.audience}).then(function(e){o.header("Content-Type","text/html"),o.status(200).send('<html><head><script type="text/javascript">sessionStorage.setItem("'+l+'", "'+e+'");window.location.href = "'+u.getBaseUrl(n)+'";<\/script></head></html>')}).catch(function(e){i(e)}):i(new a.ValidationError("Login failed. State mismatch.")):i(new a.ValidationError("Login failed. Nonce mismatch."))}),p.get(c+"/logout",function(t,r){const n=encodeURIComponent(u.getBaseUrl(t));r.header("Content-Type","text/html"),r.status(200).send('<html><head><script type="text/javascript">sessionStorage.removeItem("'+l+'");window.location.href = "https://'+e.rta+"/v2/logout/?returnTo="+n+"&client_id="+n+'";<\/script></head></html>')}),p.get("/.well-known/oauth2-client-configuration",function(t,r){r.header("Content-Type","application/json"),r.status(200).send({redirect_uris:[u.getBaseUrl(t)+c+"/login/callback"],client_name:e.clientName,post_logout_redirect_uris:[u.getBaseUrl(t)]})}),p}},function(e,t,r){e.exports.dashboardAdmins=r(48)},function(e,t,r){const n=r(2),o=r(131);e.exports.createServer=function(e){const t=n.createServer(e);var r=null;return o.fromExpress(function(e,n){return r||(r=t(e.webtaskContext)),r(e,n)})}},function(e,t,r){"use strict";var n=r(11),o=r(4),i=r(55),s=r(1),a=r(0);e.exports=function(e){return function(t,r,u){var c=t.webtaskContext&&t.webtaskContext.body||t.body||{},l=t.webtaskContext&&t.webtaskContext.headers||{};if(!(c.schedule&&"active"===c.state||"https://manage.auth0.com/"===l.referer&&l["if-none-match"]))return u();var p=a("PROVIDER");if(!p||!i[p])throw new Error("Unknown provider: "+p);var f=i[p](),d=function(e,t){var r=process.hrtime();f(e,function(e){var n=process.hrtime(r),o=1e3*n[0]+n[1]/1e6;s.info("Finished request to '"+p+"' in "+o+"ms."),t(e)})},h=new o.reporters.SlackReporter({hook:a("SLACK_INCOMING_WEBHOOK_URL"),username:"auth0-logs-to-"+p,title:"Logs Export"}),g={domain:a("AUTH0_DOMAIN"),clientId:a("AUTH0_CLIENT_ID"),clientSecret:a("AUTH0_CLIENT_SECRET"),batchSize:parseInt(a("BATCH_SIZE")),startFrom:a("START_FROM"),logTypes:a("LOG_TYPES"),logLevel:a("LOG_LEVEL"),logger:s},m="mixpanel"===p?20:100;(!g.batchSize||g.batchSize>m)&&(g.batchSize=m),g.logTypes&&!Array.isArray(g.logTypes)&&(g.logTypes=g.logTypes.replace(/\s/g,"").split(","));var v=new o.LogsProcessor(e,g),y=function(t){var r=new Date,n=r.getTime(),o=n-864e5;v.getReport(o,n).then(function(e){return h.send(e,e.checkpoint)}).then(function(){return e.read()}).then(function(r){return r.lastReportDate=t,e.write(r)})},x=function(){e.read().then(function(e){var t=n().format("DD-MM-YYYY"),r=a("DAILY_REPORT_TIME")||16;e.lastReportDate!==t&&(new Date).getHours()>=r&&y(t)})};return function(){return e.read().then(function(t){return t.lastRun=new Date,e.write(t)})}().then(function(){return v.run(d).then(function(e){e&&e.status&&e.status.error?h.send(e.status,e.checkpoint):!0!==a("SLACK_SEND_SUCCESS")&&"true"!==a("SLACK_SEND_SUCCESS")||h.send(e.status,e.checkpoint),x(),r.json(e)}).catch(function(e){h.send({error:e,logsProcessed:0},null),x(),u(e)})})}}},function(e,t,r){"use strict";var n=r(3),o=function(e){return e&&e.__esModule?e:{default:e}}(n),i=r(10),s=r(11),a=r(38),u=r(114),c=r(4),l=r(0),p=r(1),f=function(){var e=u.getClient(l("APPINSIGHTS_INSTRUMENTATIONKEY")),t=e.getEnvelope;return e.getEnvelope=function(r,n){var o=t.apply(e,[r,n]);return o.time=r.baseData.properties.date,o.os=r.baseData.properties.os,o.osVer=r.baseData.properties.os_version,o.tags["ai.device.id"]=r.baseData.properties.device,o.tags["ai.device.machineName"]="",o.tags["ai.device.type"]="mobile:"+r.baseData.properties.isMobile,o.tags["ai.device.os"]=r.baseData.properties.os,o.tags["ai.device.osVersion"]=r.baseData.properties.os_version,o.tags["ai.device.osArchitecture"]="",o.tags["ai.device.osPlatform"]=r.baseData.properties.os,r.baseData.properties.ip&&(o.tags["ai.location.ip"]=r.baseData.properties.ip),(r.baseData.properties.user_id||r.baseData.properties.user_name)&&(o.tags["ai.user.id"]=r.baseData.properties.user_id||r.baseData.properties.user_name,o.tags["ai.user.accountId"]=r.baseData.properties.user_id||r.baseData.properties.user_name,o.tags["ai.user.authUserId"]=r.baseData.properties.user_id||r.baseData.properties.user_name),r.baseData.properties.user_agent&&(o.tags["ai.user.userAgent"]=r.baseData.properties.user_agent),o},e},d=function(e,t,r){if(p.info("Exporting logs to Application Insights: "+t.length),t.forEach(function(t){var r=0;t.type_code=t.type,c.logTypes[t.type]&&(r=c.logTypes[t.type].level,t.type=c.logTypes.get(t.type)),t.ip&&""!==t.ip||delete t.ip,t.user_id&&""!==t.user_id||delete t.user_id,t.user_name&&""!==t.user_name||delete t.user_name,t.connection&&""!==t.connection||delete t.connection,t.client_name&&""!==t.client_name||delete t.client_name,t.description&&""!==t.description||delete t.description,t.isMobile=t.isMobile&&"yes"||"no",t.details&&(t.details=(0,o.default)(t.details,null,2)),t.details&&t.details.length>8185&&(t.details=t.details.substring(0,8185)+"...");var n=a.parse(t.user_agent);if(t.os=n.os.toString(),t.os_version=n.os.toVersion(),t.device=n.device.toString(),t.device_version=n.device.toVersion(),t.device&&t.device.indexOf("Generic Smartphone")>=0&&(t.device=n.os.toString(),t.device_version=n.os.toVersion()),r>=3){var i=new Error(t.type);i.name=t.type,e.trackException(i,t)}e.trackEvent(t.type,t)}),!t||!t.length)return p.info("No data to flush..."),r(null,'{ "itemsAccepted": 0 }');p.info("Flushing all data..."),e.sendPendingData(function(e){return r(null,e)})};e.exports=function(){var e=f();return e.commonProperties={auth0_domain:l("AUTH0_DOMAIN")},function(t,r){if(!t||!t.length)return r();var n=i.filter(t,function(e){return e.date&&s().diff(s(e.date),"hours")<48});return n.length?d(e,n,function(e,t){try{t=JSON.parse(t)}catch(e){return p.info("Error parsing response, this might indicate that an error occurred:",t),r(t)}return t.itemsAccepted&&t.itemsAccepted>0?r():t.errors&&t.errors.length>0?r(t.errors):(p.info("No items accepted."),r({message:"No items accepted."}))}):r()}}},function(e,t,r){"use strict";var n=r(3),o=function(e){return e&&e.__esModule?e:{default:e}}(n),i=r(7),s=r(116),a=r(11),u=r(38),c=r(4),l=r(0),p=r(1);e.exports=function(){var e=s.createBlobService(l("STORAGE_ACCOUNT_NAME"),l("STORAGE_ACCOUNT_KEY")),t=function(e){if(e.type_code=e.type,e.type=c.logTypes.get(e.type),e.user_agent&&e.user_agent.length){var t=u.parse(e.user_agent);e.os=t.os.toString(),e.os_version=t.os.toVersion(),e.device=t.device.toString(),e.device_version=t.device.toVersion()}return e};return function(r,n){if(!r||!r.length)return n();p.info("Sending "+r.length+" logs to Azure Blob Storage."),i.eachLimit(r.map(t),5,function(t,r){var n=a(t.date),i=n.format("YYYY/MM/DD")+"/"+n.format("HH")+"/"+t._id+".json";e.createBlockBlobFromText(l("STORAGE_CONTAINER_NAME"),i,(0,o.default)(t),r)},function(e){return e?n(e):(p.info("Upload complete."),n())})}}},function(e,t,r){"use strict";var n=r(3),o=function(e){return e&&e.__esModule?e:{default:e}}(n),i=r(115),s=r(0),a=r(1);e.exports=function(){i.config.update({accessKeyId:s("AWS_ACCESS_KEY_ID"),secretAccessKey:s("AWS_SECRET_KEY"),region:s("AWS_REGION")});var e={stream:s("CLOUDWATCH_LOG_STREAM_NAME"),group:s("CLOUDWATCH_LOG_GROUP_NAME"),token:null},t=new i.CloudWatchLogs({apiVersion:"2014-03-28"}),r=function(r){var n={logGroupName:e.group,logStreamNamePrefix:e.stream,limit:1};t.describeLogStreams(n,function(t,n){return n&&n.logStreams&&1===n.logStreams.length&&n.logStreams[0].uploadSequenceToken?(e.token=n.logStreams[0].uploadSequenceToken,r()):r(t||"Cannot find Log Stream - logGroupName: "+e.group+", logStreamName: "+e.stream)})};return function(n,i){if(!n||!n.length)return i();a.info("Sending "+n.length+" logs to Cloudwatch...");var s=n.map(function(e){return{timestamp:(new Date).getTime(),message:(0,o.default)(e)}}),u={logStreamName:e.stream,logGroupName:e.group,logEvents:s,sequenceToken:e.token};t.putLogEvents(u,function(t,n){if(t&&"InvalidSequenceTokenException"===t.code)return r(function(e){return i(e||t)});n&&n.nextSequenceToken&&(e.token=n.nextSequenceToken),i(t,n)})}}},function(e,t,r){"use strict";var n=r(52),o=r(53),i=r(54),s=r(56),a=r(57),u=r(58),c=r(59),l=r(60),p=r(61),f=r(62),d=r(63);e.exports={appinsights:n,blobstorage:o,cloudwatch:i,logentries:s,loggly:a,logstash:u,mixpanel:c,papertrail:l,segment:p,splunk:f,sumologic:d}},function(e,t,r){"use strict";var n=r(3),o=function(e){return e&&e.__esModule?e:{default:e}}(n),i=r(7),s=r(11),a=r(20),u=r(0),c=r(1);e.exports=function(){var e=a.createClient({url:"https://webhook.logentries.com/noformat/logs/"+u("LOGENTRIES_TOKEN")});return function(t,r){return t&&t.length?(c.info("Uploading blobs..."),i.eachLimit(t,5,function(t,r){var n=s(t.date),i=n.format("YYYY/MM/DD")+"/"+n.format("HH")+"/"+t._id+".json";c.info("Uploading "+i+"."),e.log((0,o.default)(t),r)},function(e){return e?r(e):(c.info("Upload complete."),r())})):r()}}},function(e,t,r){"use strict";var n=r(18),o=r(0),i=r(1);e.exports=function(){var e=n.createClient({token:o("LOGGLY_CUSTOMER_TOKEN"),subdomain:o("LOGGLY_SUBDOMAIN")||"-",tags:["auth0"]});return function(t,r){if(!t||!t.length)return r();i.info("Sending "+t.length+" logs to Loggly."),e.log(t,function(e){return e?(i.info("Error sending logs to Loggly",e),r(e)):(i.info("Upload complete."),r())})}}},function(e,t,r){"use strict";function n(e){return e&&e.__esModule?e:{default:e}}var o=r(3),i=n(o),s=r(69),a=n(s),u=r(7),c=r(12),l=r(13),p=r(4),f=r(0),d=r(1);e.exports=function(){var e=Date.now(),t=f("LOGSTASH_URL");if(f("LOGSTASH_TOKEN")){var r=l.parse(t);t=r.query?t+"&token="+f("LOGSTASH_TOKEN"):t+"?token="+f("LOGSTASH_TOKEN")}var n=function(r,n){if(!r)return n();var o=f("LOGSTASH_INDEX"),s={post_date:e,type_description:p.logTypes.get(r.type)};(0,a.default)(r).forEach(function(e){s[e]=r[e]}),s[o]=r[o]||"auth0",s.message=(0,i.default)(r);var u={method:"POST",timeout:2e3,url:t,headers:{"cache-control":"no-cache","content-type":"application/json"},body:s,json:!0};f("LOGSTASH_USER")&&f("LOGSTASH_PASSWORD")&&(u.auth={user:f("LOGSTASH_USER"),pass:f("LOGSTASH_PASSWORD"),sendImmediately:!0}),c(u,function(e,t,r){var o=e||r&&r.error||null;n(o)})};return function(e,t){if(!e||!e.length)return t();d.info("Sending "+e.length+" logs to Logstash."),u.eachLimit(e,10,n,t)}}},function(e,t,r){"use strict";var n=r(124),o=r(4),i=r(0),s=r(1);e.exports=function(){var e=function(e){return e.map(function(e){return{name:e.name,message:e.message,stack:e.stack}})},t=n.init(i("MIXPANEL_TOKEN"),{key:i("MIXPANEL_KEY")}),r=function r(n,o){n&&n.length||o(),t.import_batch(n,function(i){if(i&&i.length>0){if(n.length>10){var a=n.splice(0,10);return t.import_batch(a,function(t){return t&&t.length>0?(s.error(t),o(e(t))):(s.info(a.length+" events successfully sent to mixpanel."),r(n,o))})}return s.error(i),o(e(i))}return s.info(n.length+" events successfully sent to mixpanel."),o()})};return function(e,t){if(!e||!e.length)return t();s.info(e.length+" logs received.");var n=Date.now(),i=e.map(function(e){var t=o.logTypes.get(e.type);return e.time=n,e.distinct_id=e.user_id||e.user_name||e.client_id||e._id,{event:t,properties:e}});return r(i,t)}}},function(e,t,r){"use strict";var n=r(3),o=function(e){return e&&e.__esModule?e:{default:e}}(n),i=r(7),s=r(22),a=r(0),u=r(1);e.exports=function(){r(112).Papertrail;var e=new s.Logger({transports:[new s.transports.Papertrail({host:a("PAPERTRAIL_HOST"),port:a("PAPERTRAIL_PORT"),hostname:a("PAPERTRAIL_SYSTEM")||"auth0-logs"})]});return function(t,r){if(!t||!t.length)return r();u.info("Sending "+t.length+" logs to Papertrail."),i.eachLimit(t,5,function(t,r){e.info((0,o.default)(t),r)},function(e){return e?r(e):(console.log("Upload complete."),r())})}}},function(e,t,r){"use strict";var n=r(10),o=r(7),i=r(113),s=r(4),a=r(0),u=r(1);e.exports=function(){var e=new i(a("SEGMENT_KEY"));return function(t,r){if(!t||!t.length)return r();u.info("Sending "+t.length+" logs to Segment."),o.eachLimit(t,10,function(t,r){return t.user_id?req.auth0.users.get({id:t.user_id}).then(function(o){e.track({userId:t.user_id,event:s.logTypes.get(t.type),properties:n.extend({},o.user_metadata,n.omit(o,["user_metadata","app_metadata"]),o.app_metadata)},r)}).catch(function(n){return 404===n.statusCode?e.track({userId:t.user_id,event:s.logTypes.get(t.type),properties:{}},r):r(n)}):r()},r)}}},function(e,t,r){"use strict";var n=r(109).Logger,o=r(0),i=r(1);e.exports=function(){var e=new n({token:o("SPLUNK_TOKEN"),url:o("SPLUNK_URL"),port:o("SPLUNK_COLLECTOR_PORT")||8088,path:o("SPLUNK_COLLECTOR_PATH")||"/services/collector/event/1.0",maxBatchCount:0});return e.requestOptions={timeout:5e3},e.error=function(e,t){i.error("error",e,"context",t)},function(t,r){if(!t||!t.length)return r();t.forEach(function(t){e.send({message:t})}),i.info("Sending "+t.length+" logs to Splunk..."),e.flush(function(e,t,n){return i.info("Splunk response",n),e?r({error:e,message:"Error sending logs to Splunk"}):(i.info("Upload complete."),r())})}}},function(e,t,r){"use strict";var n=r(3),o=function(e){return e&&e.__esModule?e:{default:e}}(n),i=r(10),s=r(127),a=r(129),u=r(0),c=r(1);e.exports=function(){var e="auth0-logs-to-sumologic-"+s.v4(),t=function(e,t){0===e.length&&t();try{a.post(u("SUMOLOGIC_URL")).send(e.map(function(e){return(0,o.default)(e)}).join("\n")).set("Content-Type","application/json").end(function(e,r){if(e||r.statusCode<200||r.statusCode>=400){var n=r.error||e.response,o=n&&n.text&&n.text.replace(/<\/?[^>]+>/gi,"");return t(o||e||r.statusCode)}return t()})}catch(e){return t(e)}};return function(r,n){if(!r||!r.length)return n();c.info("Sending "+r.length+" logs to Sumologic.");var o=(new Date).toUTCString(),s=[];return r.forEach(function(t){var r={sessionId:e,timestamp:o};s.push(i.extend(r,t))}),t(s,n)}}},function(e,t,r){"use strict";var n=r(8).Router,o=r(6).middlewares,i=r(0),s=r(1);e.exports=function(){var e=n(),t=o.validateHookToken(i("AUTH0_DOMAIN"),i("WT_URL"),i("EXTENSION_SECRET"));return e.use("/on-uninstall",t("/.extensions/on-uninstall")),e.use(o.managementApiClient({domain:i("AUTH0_DOMAIN"),clientId:i("AUTH0_CLIENT_ID"),clientSecret:i("AUTH0_CLIENT_SECRET")})),e.delete("/on-uninstall",function(e,t){var r=i("AUTH0_CLIENT_ID");e.auth0.clients.delete({client_id:r}).then(function(){s.debug("Deleted client "+r),t.sendStatus(204)}).catch(function(e){s.debug("Error deleting client: "+i("AUTH0_CLIENT_ID")),s.error(e),t.sendStatus(204)})}),e}},function(e,t,r){"use strict";(function(t){var n=(r(121),r(120)),o=(r(36),r(6).urlHelpers),i=r(0);e.exports=function(){var e='\n  <!DOCTYPE html>\n  <html lang="en">\n  <head>\n    <title><%= config.TITLE %></title>\n    <meta charset="UTF-8" />\n    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />\n    <meta name="viewport" content="width=device-width, initial-scale=1.0" />\n    <link rel="shortcut icon" href="https://cdn.auth0.com/styleguide/4.6.13/lib/logos/img/favicon.png">\n    <meta name="viewport" content="width=device-width, initial-scale=1">\n    <link rel="stylesheet" type="text/css" href="https://cdn.auth0.com/styles/zocial.min.css" />\n    <link rel="stylesheet" type="text/css" href="https://cdn.auth0.com/manage/v0.3.1672/css/index.min.css" />\n    <link rel="stylesheet" type="text/css" href="https://cdn.auth0.com/styleguide/4.6.13/index.min.css" />\n    <% if (assets.style) { %><link rel="stylesheet" type="text/css" href="/app/<%= assets.style %>" /><% } %>\n    <% if (assets.version) { %><link rel="stylesheet" type="text/css" href="//cdn.auth0.com/extensions/auth0-logs-to-provider/assets/auth0-logs-to-provider.ui.<%= assets.version %>.css" /><% } %>\n    <% if (assets.customCss) { %><link rel="stylesheet" type="text/css" href="<%= assets.customCss %>" /><% } %>\n  </head>\n  <body>\n    <div id="app"></div>\n    <script type="text/javascript" src="//cdn.auth0.com/w2/auth0-7.0.4.min.js"><\/script>\n    <script type="text/javascript" src="//cdn.auth0.com/manage/v0.3.1672/js/bundle.js"><\/script>\n    <script type="text/javascript">window.config = <%- JSON.stringify(config) %>;<\/script>\n    <% if (assets.vendors) { %><script type="text/javascript" src="/app/<%= assets.vendors %>"><\/script><% } %>\n    <% if (assets.app) { %><script type="text/javascript" src="<%= assets.app %>"><\/script><% } %>\n    <% if (assets.version) { %>\n    <script type="text/javascript" src="//cdn.auth0.com/extensions/auth0-logs-to-provider/assets/auth0-logs-to-provider.ui.vendors.<%= assets.version %>.js"><\/script>\n    <script type="text/javascript" src="//cdn.auth0.com/extensions/auth0-logs-to-provider/assets/auth0-logs-to-provider.ui.<%= assets.version %>.js"><\/script>\n    <% } %>\n  </body>\n  </html>\n  ';return function(t,r,s){if(0===t.url.indexOf("/api"))return s();var a={AUTH0_DOMAIN:i("AUTH0_DOMAIN"),AUTH0_CLIENT_ID:i("EXTENSION_CLIENT_ID"),AUTH0_MANAGE_URL:i("AUTH0_MANAGE_URL")||"https://manage.auth0.com",BASE_URL:o.getBaseUrl(t),BASE_PATH:o.getBasePath(t),TITLE:i("TITLE")};return r.send(n.render(e,{config:a,assets:{customCss:i("CUSTOM_CSS"),version:"0.1.0"}}))}}}).call(t,"/")},function(e,t,r){"use strict";var n=r(10),o=r(8).Router,i=r(6).middlewares,s=r(0),a=r(65);e.exports=function(e){var t=o(),r=i.authenticateAdmins({credentialsRequired:!0,secret:s("EXTENSION_SECRET"),audience:"urn:logs-to-provider",baseUrl:s("PUBLIC_WT_URL")||s("WT_URL"),onLoginSuccess:function(e,t,r){return r()}});return t.get("/",a()),t.get("/api/report",r,function(t,r,o){return e.read().then(function(e){var o=e&&e.lastRun,i=e&&e.logs?n.orderBy(e.logs,"start","desc"):[],s=t.query.filter&&"errors"===t.query.filter?n.filter(i,function(e){return!!e.error}):i,a=t.query.page&&parseInt(t.query.page)?parseInt(t.query.page)-1:0,u=t.query.per_page&&parseInt(t.query.per_page)||10,c=u*a;return r.json({logs:s.slice(c,c+u),total:s.length,lastRun:o})}).catch(o)}),t}},function(e,t,r){"use strict";var n=r(8),o=r(103);e.exports=function(){var e=n.Router();return e.get("/",function(e,t){t.status(200).send(o)}),e}},function(e,t,r){"use strict";var n=r(6),o=r(39),i=r(0),s=r(1),a=n.createServer(function(e,t){return s.info("Starting Logs to Cloudwatch extension - Version:","0.1.0"),o(e,t)});e.exports=function(e,t,r){i.setValue("PUBLIC_WT_URL",n.urlHelpers.getWebtaskUrl(t)),a(e,t,r)}},function(e,t,r){e.exports={default:r(73),__esModule:!0}},function(e,t,r){"use strict";function n(e,t){return function(r,n,o){if(r.cookies)return o();var s=r.headers.cookie,c=!e||Array.isArray(e)?e||[]:[e];if(r.secret=c[0],r.cookies=Object.create(null),r.signedCookies=Object.create(null),!s)return o();r.cookies=u.parse(s,t),0!==c.length&&(r.signedCookies=a(r.cookies,c),r.signedCookies=i(r.signedCookies)),r.cookies=i(r.cookies),o()}}function o(e){if("string"==typeof e&&"j:"===e.substr(0,2))try{return JSON.parse(e.slice(2))}catch(e){return}}function i(e){for(var t,r,n=Object.keys(e),i=0;i<n.length;i++)t=n[i],(r=o(e[t]))&&(e[t]=r);return e}function s(e,t){if("string"==typeof e){if("s:"!==e.substr(0,2))return e;for(var r=!t||Array.isArray(t)?t||[]:[t],n=0;n<r.length;n++){var o=c.unsign(e.slice(2),r[n]);if(!1!==o)return o}return!1}}function a(e,t){for(var r,n,o,i=Object.keys(e),a=Object.create(null),u=0;u<i.length;u++)n=i[u],o=e[n],r=s(o,t),o!==r&&(a[n]=r,delete e[n]);return a}var u=r(71),c=r(118);e.exports=n,e.exports.JSONCookie=o,e.exports.JSONCookies=i,e.exports.signedCookie=s,e.exports.signedCookies=a},function(e,t,r){"use strict";function n(e,t){if("string"!=typeof e)throw new TypeError("argument str must be a string");for(var r={},n=t||{},o=e.split(u),a=n.decode||s,c=0;c<o.length;c++){var l=o[c],p=l.indexOf("=");if(!(p<0)){var f=l.substr(0,p).trim(),d=l.substr(++p,l.length).trim();'"'==d[0]&&(d=d.slice(1,-1)),void 0==r[f]&&(r[f]=i(d,a))}}return r}function o(e,t,r){var n=r||{},o=n.encode||a;if("function"!=typeof o)throw new TypeError("option encode is invalid");if(!c.test(e))throw new TypeError("argument name is invalid");var i=o(t);if(i&&!c.test(i))throw new TypeError("argument val is invalid");var s=e+"="+i;if(null!=n.maxAge){var u=n.maxAge-0;if(isNaN(u))throw new Error("maxAge should be a Number");s+="; Max-Age="+Math.floor(u)}if(n.domain){if(!c.test(n.domain))throw new TypeError("option domain is invalid");s+="; Domain="+n.domain}if(n.path){if(!c.test(n.path))throw new TypeError("option path is invalid");s+="; Path="+n.path}if(n.expires){if("function"!=typeof n.expires.toUTCString)throw new TypeError("option expires is invalid");s+="; Expires="+n.expires.toUTCString()}if(n.httpOnly&&(s+="; HttpOnly"),n.secure&&(s+="; Secure"),n.sameSite){switch("string"==typeof n.sameSite?n.sameSite.toLowerCase():n.sameSite){case!0:s+="; SameSite=Strict";break;case"lax":s+="; SameSite=Lax";break;case"strict":s+="; SameSite=Strict";break;default:throw new TypeError("option sameSite is invalid")}}return s}function i(e,t){try{return t(e)}catch(t){return e}}t.parse=n,t.serialize=o;var s=decodeURIComponent,a=encodeURIComponent,u=/; */,c=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/},function(e,t,r){var n=r(9),o=n.JSON||(n.JSON={stringify:JSON.stringify});e.exports=function(e){return o.stringify.apply(o,arguments)}},function(e,t,r){r(97),e.exports=r(9).Object.keys},function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},function(e,t,r){var n=r(17);e.exports=function(e){if(!n(e))throw TypeError(e+" is not an object!");return e}},function(e,t,r){var n=r(28),o=r(93),i=r(92);e.exports=function(e){return function(t,r,s){var a,u=n(t),c=o(u.length),l=i(s,c);if(e&&r!=r){for(;c>l;)if((a=u[l++])!=a)return!0}else for(;c>l;l++)if((e||l in u)&&u[l]===r)return e||l||0;return!e&&-1}}},function(e,t){var r={}.toString;e.exports=function(e){return r.call(e).slice(8,-1)}},function(e,t,r){var n=r(74);e.exports=function(e,t,r){if(n(e),void 0===t)return e;switch(r){case 1:return function(r){return e.call(t,r)};case 2:return function(r,n){return e.call(t,r,n)};case 3:return function(r,n,o){return e.call(t,r,n,o)}}return function(){return e.apply(t,arguments)}}},function(e,t,r){var n=r(17),o=r(16).document,i=n(o)&&n(o.createElement);e.exports=function(e){return i?o.createElement(e):{}}},function(e,t){e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(e,t,r){var n=r(16),o=r(9),i=r(78),s=r(82),a=r(26),u=function(e,t,r){var c,l,p,f=e&u.F,d=e&u.G,h=e&u.S,g=e&u.P,m=e&u.B,v=e&u.W,y=d?o:o[t]||(o[t]={}),x=y.prototype,_=d?n:h?n[t]:(n[t]||{}).prototype;d&&(r=t);for(c in r)(l=!f&&_&&void 0!==_[c])&&a(y,c)||(p=l?_[c]:r[c],y[c]=d&&"function"!=typeof _[c]?r[c]:m&&l?i(p,n):v&&_[c]==p?function(e){var t=function(t,r,n){if(this instanceof e){switch(arguments.length){case 0:return new e;case 1:return new e(t);case 2:return new e(t,r)}return new e(t,r,n)}return e.apply(this,arguments)};return t.prototype=e.prototype,t}(p):g&&"function"==typeof p?i(Function.call,p):p,g&&((y.virtual||(y.virtual={}))[c]=p,e&u.R&&x&&!x[c]&&s(x,c,p)))};u.F=1,u.G=2,u.S=4,u.P=8,u.B=16,u.W=32,u.U=64,u.R=128,e.exports=u},function(e,t,r){var n=r(85),o=r(89);e.exports=r(14)?function(e,t,r){return n.f(e,t,o(1,r))}:function(e,t,r){return e[t]=r,e}},function(e,t,r){e.exports=!r(14)&&!r(15)(function(){return 7!=Object.defineProperty(r(79)("div"),"a",{get:function(){return 7}}).a})},function(e,t,r){var n=r(77);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==n(e)?e.split(""):Object(e)}},function(e,t,r){var n=r(75),o=r(83),i=r(95),s=Object.defineProperty;t.f=r(14)?Object.defineProperty:function(e,t,r){if(n(e),t=i(t,!0),n(r),o)try{return s(e,t,r)}catch(e){}if("get"in r||"set"in r)throw TypeError("Accessors not supported!");return"value"in r&&(e[t]=r.value),e}},function(e,t,r){var n=r(26),o=r(28),i=r(76)(!1),s=r(90)("IE_PROTO");e.exports=function(e,t){var r,a=o(e),u=0,c=[];for(r in a)r!=s&&n(a,r)&&c.push(r);for(;t.length>u;)n(a,r=t[u++])&&(~i(c,r)||c.push(r));return c}},function(e,t,r){var n=r(86),o=r(80);e.exports=Object.keys||function(e){return n(e,o)}},function(e,t,r){var n=r(81),o=r(9),i=r(15);e.exports=function(e,t){var r=(o.Object||{})[e]||Object[e],s={};s[e]=t(r),n(n.S+n.F*i(function(){r(1)}),"Object",s)}},function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},function(e,t,r){var n=r(91)("keys"),o=r(96);e.exports=function(e){return n[e]||(n[e]=o(e))}},function(e,t,r){var n=r(16),o=n["__core-js_shared__"]||(n["__core-js_shared__"]={});e.exports=function(e){return o[e]||(o[e]={})}},function(e,t,r){var n=r(27),o=Math.max,i=Math.min;e.exports=function(e,t){return e=n(e),e<0?o(e+t,0):i(e,t)}},function(e,t,r){var n=r(27),o=Math.min;e.exports=function(e){return e>0?o(n(e),9007199254740991):0}},function(e,t,r){var n=r(25);e.exports=function(e){return Object(n(e))}},function(e,t,r){var n=r(17);e.exports=function(e,t){if(!n(e))return e;var r,o;if(t&&"function"==typeof(r=e.toString)&&!n(o=r.call(e)))return o;if("function"==typeof(r=e.valueOf)&&!n(o=r.call(e)))return o;if(!t&&"function"==typeof(r=e.toString)&&!n(o=r.call(e)))return o;throw TypeError("Can't convert object to primitive value")}},function(e,t){var r=0,n=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++r+n).toString(36))}},function(e,t,r){var n=r(94),o=r(87);r(88)("keys",function(){return function(e){return o(n(e))}})},function(e,t,r){var n=r(100),o=r(99);t.Produce=n,t.Parse=o},function(e,t,r){var n=["kern","user","mail","daemon","auth","syslog","lpr","news","uucp","clock","sec","ftp","ntp","audit","alert","clock","local0","local1","local2","local3","local4","local5","local6","local7"],o=["emerg","alert","crit","err","warn","notice","info","debug"],s={Jan:0,Feb:1,Mar:2,Apr:3,May:4,Jun:5,Jul:6,Aug:7,Sep:8,Oct:9,Nov:10,Dec:11},a={hashAlgorithm:[null,"SHA1","SHA256"],keyBlobType:{C:"PKIX Certificate",P:"OpenPGP KeyID",K:"Public Key",N:"No key information",U:"Unknown"}},u=function(){};u.prototype.parse=function(e,t){if("function"==typeof Buffer&&Buffer.isBuffer(e))e=e.toString("utf8",0);else if("string"!=typeof e)return e;var r={originalMessage:e},n=e.split(" ");if(n.length<2)return r;var o=this.decodePri(n[0]);if(o)for(var s in o)r[s]=o[s];var a;if(n[0].match(/^(<\d+>\d)$/)){if(n.shift(),a=n.shift(),r.type="RFC5424",r.time=this.parseTimeStamp(a),r.host=this.decideValue(n.shift()),r.appName=this.decideValue(n.shift()),r.pid=this.decideValue(n.shift()),r.msgID=this.decideValue(n.shift()),"-"!==n[0]){var u=0;for(i=n.length-1;i>-1;i--)if("]"===n[i].substr(-1)){u=i,u++;break}if(0!==u){var c=n.splice(0,u).join(" ");r.structuredData=this.parseStructure(c),r.structuredData.ssign?r.structuredData.signedBlock=this.parseSignedBlock(r.structuredData):r.structuredData["ssign-cert"]&&(r.structuredData.signedBlock=this.parseSignedCertificate(r.structuredData))}}else n.shift();r.message=n.join(" ")}else n[0].match(/^(<\d+>\d+:)$/)?(r.type="RFC3164",a=n.splice(0,1).join(" ").replace(/^(<\d+>)/,""),r.time=this.parseBsdTime(a),r.message=n.join(" ")):n[0].match(/^(<\d+>\w+)/)&&(r.type="RFC3164",""===n[1]&&n.splice(1,1),a=n.splice(0,3).join(" ").replace(/^(<\d+>)/,""),r.time=this.parseBsdTime(a),r.host=n.shift(),r.message=n.join(" "));if(!t)return r;t(r)},u.prototype.decideValue=function(e){return"-"===e?null:e},u.prototype.decodePri=function(e){if("string"==typeof e){var t=e.match(/^<(\d+)>/);if(!t)return!1;var r={prival:parseInt(t[1],10)};if(t[2]&&(r.versio=parseInt(t[2],10)),r.prival&&r.prival>=0&&r.prival<=191)r.facilityID=parseInt(r.prival/8,10),r.severityID=r.prival-8*r.facilityID,r.facilityID<24&&r.severityID<8&&(r.facility=n[r.facilityID],r.severity=o[r.severityID]);else if(r.prival>=191)return!1;return r}},u.prototype.parseTimeStamp=function(e){if("string"==typeof e){var t;return(t=this.parse8601(e))?t:(t=this.parseRfc3339(e))?t:(t=this.parseBsdTime(e))||t}},u.prototype.parseRfc3339=function(e){var t,r,n,o=1,i=e.split("T");if(i.length<2)return!1;var s=i[0].split("-"),a=i[1].split(":"),u=a[a.length-1];if(offsetFieldIdentifier=u.charAt(u.length-1),"Z"===offsetFieldIdentifier)t=0,a[a.length-1]=u.substr(0,u.length-2);else{if(-1!=u[u.length-1].indexOf("+")?(r="+",o=1):(r="-",o=-1),n=u.split(r),n.length<2)return!1;a[a.length-1]=n[0],n=n[1].split(":"),t=60*n[0]+n[1],t=60*t*1e3}return new Date(Date.UTC(s[0],s[1]-1,s[2],a[0],a[1],a[2])+t*o)},u.prototype.parseBsdTime=function(e){var t,r=e.match(/(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s+(\d{1,2})\s+(\d{2}):(\d{2}):(\d{2})/);return r&&(currDate=new Date,t=new Date(currDate.getUTCFullYear(),s[r[1]],r[2],r[3],r[4],r[5])),t},u.prototype.parse8601=function(e){var t=new Date(Date.parse(e));if("Invalid Date"!==t.toString())return t},u.prototype.parseStructure=function(e){for(var t={},r=0,n=!1,o="",i="",s="",a=0;a<e.length;a++){var u=e[a];switch(r){case 0:r="["===u?1:0;break;case 1:" "!=u?o+=u:(t[o]={},r=2);break;case 2:"="===u?(t[o][i]="",r=3):"]"===u?(o="",r=0):" "!=u&&(i+=u);break;case 3:r='"'===u?4:null;break;case 4:"\\"!==u||n?'"'!==u||n?(s+=u,n=!1):(t[o][i]=s,i="",s="",r=2):n=!0}}return t},u.prototype.parseSignedBlock=function(e){if("object"!=typeof e)return!1;var t={},r={};if(e.structuredData&&e.structuredData.ssign)t=e.structuredData.ssign;else if(e.ssign)t=e.ssign;else{if(!e.VER)return!1;t=e}var n=t.VER.match(/^(\d{2})(\d|\w)(\d)$/);if(null!==n&&(r.version=n[1],r.hashAlgorithm=parseInt(n[2],10),r.hashAlgoString=a.hashAlgorithm[r.hashAlgorithm],r.sigScheme=parseInt(n[3],10)),r.rebootSessionID=parseInt(t.RSID,10),r.signatureGroup=parseInt(t.SG,10),r.signaturePriority=parseInt(t.SPRI,10),r.globalBlockCount=parseInt(t.GBC,10),r.firstMsgNumber=parseInt(t.FMN,10),r.msgCount=parseInt(t.CNT,10),r.hashBlock=t.HB.split(/\s/),"function"==typeof Buffer){for(var o in r.hashBlock)r.hashBlock[o]=new Buffer(r.hashBlock[o],encoding="base64");r.thisSignature=new Buffer(t.SIGN,encoding="base64")}else r.thisSignature=t.SIGN;return r},u.prototype.parseSignedCertificate=function(e){if("object"!=typeof e)return!1;var t={},r={};if(e.structuredData&&e.structuredData["ssign-cert"])t=e.structuredData["ssign-cert"];else if(e["ssign-cert"])t=e["ssign-cert"];else{if(!e.VER)return!1;t=e}var n=t.VER.match(/^(\d{2})(\d|\w)(\d)$/);null!==n&&(r.version=n[1],r.hashAlgorithm=parseInt(n[2],10),r.hashAlgoString=a.hashAlgorithm[r.hashAlgorithm],r.sigScheme=parseInt(n[3],10)),r.rebootSessionID=parseInt(t.RSID,10),r.signatureGroup=parseInt(t.SG,10),r.signaturePriority=parseInt(t.SPRI,10),r.totalPayloadLength=parseInt(t.TPBL,10),r.payloadIndex=parseInt(t.INDEX,10),r.fragmentLength=parseInt(t.FLEN,10);var o=t.FRAG.split(/\s/);return r.payloadTimestamp=this.parseTimeStamp(o[0]),r.payloadType=o[1],r.payloadName=a.keyBlobType[o[1]],"function"==typeof Buffer?(r.keyBlob=new Buffer(o[2],encoding="base64"),r.thisSignature=new Buffer(t.SIGN,encoding="base64")):(r.keyBlob=o[2],r.thisSignature=t.SIGN),r},e.exports=new u},function(e,t,r){function n(e){return"number"!=typeof e?e:e=e<10?"0"+e:e}function o(e){e instanceof Date||(e=new Date(Date()));var t=n(e.getHours()),r=n(e.getMinutes()),o=n(e.getSeconds()),i=e.getMonth(),s=e.getDate();return s<10&&(s=" "+s),l[i]+" "+s+" "+t+":"+r+":"+o}function i(e){e instanceof Date||(e=new Date(Date()));for(var t,r=Math.abs(e.getTimezoneOffset()),o=0;r>=60;)o++,r-=60;return t=e.getTimezoneOffset()<0?"+"+n(o)+":"+n(r):e.getTimezoneOffset()>0?"-"+n(o)+":"+n(r):"Z",formattedDate=e.getUTCFullYear()+"-"+n(e.getUTCMonth()+1)+"-"+n(e.getUTCDate())+"T"+n(e.getUTCHours())+":"+n(e.getUTCMinutes())+":"+n(e.getUTCSeconds())+"."+n(e.getUTCMilliseconds())+t,formattedDate}function s(e){var t={};return"string"!=typeof e.facility||e.facility.match(/^\d+$/)?parseInt(e.facility,10)&&parseInt(e.facility,10)<24&&(t.facility=parseInt(e.facility,10)):t.facility=u[e.facility.toLowerCase()],"string"!=typeof e.severity||e.severity.match(/^\d+$/)?parseInt(e.severity,10)&&parseInt(e.severity,10)<8&&(t.severity=parseInt(e.severity,10)):t.severity=c[e.severity.toLowerCase()],!isNaN(t.severity)&&!isNaN(t.facility)&&(t.prival=8*t.facility+t.severity,t.str=e.version?"<"+t.prival+">"+e.version:"<"+t.prival+">",t.str)}function a(e){if("object"!=typeof e)return!1;var t="";for(var r in e){sdElement=e[r],t+="["+r;for(var n in sdElement)sdElement[n]=sdElement[n].toString().replace(/(\]|\\|")/g,"\\$1"),t+=" "+n+'="'+sdElement[n]+'"';t+="]"}return t}var u={kern:0,user:1,mail:2,daemon:3,auth:4,syslog:5,lpr:6,news:7,uucp:8,clock:9,sec:10,ftp:11,ntp:12,audit:13,alert:14,local0:16,local1:17,local2:18,local3:19,local4:20,local5:21,local6:22,local7:23},c={emerg:0,emergency:0,alert:1,crit:2,critical:2,err:3,error:3,warn:4,warning:4,notice:5,info:6,information:6,informational:6,debug:7},l=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],p=function(e){e&&"object"==typeof e&&e.type?this.type=e.type.match(/bsd|3164/i)?"RFC3164":"RFC5424":this.type=e&&"string"==typeof e&&e.match(/bsd|3164/i)?"RFC3164":"RFC5424",e&&e.facility&&u[e.facility]&&(this.facility=e.facility),e&&e.pid&&parseInt(e.pid,10)&&(this.pid=e.pid),e&&e.host&&(this.host=e.host.replace(/\s+/g,"")),e&&e.appName&&(this.appName=e.appName.replace(/\s+/g,"")),e&&e.msgID&&(this.msgID=e.msgID.replace(/\s+/g,""))};p.prototype.produce=function(e,t){e.time instanceof Date&&!e.date&&(e.date=e.time);var r=[];if(!e.date instanceof Date&&(e.date=new Date(Date())),e.facility||(e.facility=this.facility),"RFC5424"==this.type){if(e.hasOwnProperty("prival")&&e.prival>=0&&e.prival<=191)var n="<"+e.prival+">1";else var n=s({facility:e.facility,severity:e.severity,version:1});if(!1===n)return!1;r.push(n),r.push(i(e.date)),r.push(e.host||this.host||"-"),r.push(e.appName||this.appName||"-"),r.push(e.pid||this.pid||"-"),r.push(e.msgID||this.msgID||"-"),e.structuredData?r.push(a(e.structuredData)||"-"):r.push("-"),e.message||(e.message="-")}else if(e.timestamp=o(e.date),r.push(s({facility:e.facility,severity:e.severity})+e.timestamp),r.push(e.host||this.host),r.push(),e.appName||this.appName){var u=e.appName||this.appName,c=e.pid||this.pid;parseInt(c,10)?r.push(u+"["+c+"]:"):r.push(u+":")}var l=r.filter(function(e){return e}).map(function(e){return String(e).trim()}).join(" ");return l+=" "+e.message||"",r.push(l),t?t(l):l},p.prototype.debug=function(e,t){return e.severity="debug",this.produce(e,t)},p.prototype.info=function(e,t){return e.severity="info",this.produce(e,t)},p.prototype.notice=function(e,t){return e.severity="notice",this.produce(e,t)},p.prototype.warn=function(e,t){return e.severity="warn",this.produce(e,t)},p.prototype.crit=function(e,t){return e.severity="crit",this.produce(e,t)},p.prototype.alert=function(e,t){return e.severity="alert",this.produce(e,t)},p.prototype.emergency=function(e,t){return e.severity="emergency",this.produce(e,t)},e.exports=p},function(e,t){e.exports={_from:"loggly@^1.1.0",_id:"loggly@1.1.1",_inBundle:!1,_integrity:"sha1-Cg/B0/o6XsRP3HuJe+uipGlc6+4=",_location:"/loggly",_phantomChildren:{asynckit:"0.4.0",aws4:"1.7.0",chalk:"1.1.3","combined-stream":"1.0.6","core-util-is":"1.0.2",extend:"3.0.1","forever-agent":"0.6.1",inherits:"2.0.3","is-my-json-valid":"2.17.2","is-typedarray":"1.0.0",isarray:"1.0.0",isstream:"0.1.2","json-stringify-safe":"5.0.1",jsprim:"1.4.1","mime-types":"2.1.18","oauth-sign":"0.8.2","pinkie-promise":"2.0.1",sshpk:"1.14.1",stringstream:"0.0.5","tough-cookie":"2.3.4","util-deprecate":"1.0.2"},_requested:{type:"range",registry:!0,raw:"loggly@^1.1.0",name:"loggly",escapedName:"loggly",rawSpec:"^1.1.0",saveSpec:null,fetchSpec:"^1.1.0"},_requiredBy:["/"],_resolved:"https://registry.npmjs.org/loggly/-/loggly-1.1.1.tgz",_shasum:"0a0fc1d3fa3a5ec44fdc7b897beba2a4695cebee",_spec:"loggly@^1.1.0",_where:"E:\\Projects\\auth0-logs-to-provider",author:{name:"Charlie Robbins",email:"charlie.robbins@gmail.com"},bugs:{url:"https://github.com/winstonjs/node-loggly/issues"},bundleDependencies:!1,dependencies:{"json-stringify-safe":"5.0.x",request:"2.75.x",timespan:"2.3.x"},deprecated:!1,description:"A client implementation for Loggly cloud Logging-as-a-Service API",devDependencies:{"common-style":"^3.1.0",vows:"0.8.x"},engines:{node:">= 0.8.0"},homepage:"https://github.com/winstonjs/node-loggly#readme",keywords:["cloud computing","api","logging","loggly"],license:"MIT",main:"./lib/loggly",name:"loggly",repository:{type:"git",url:"git+ssh://git@github.com/winstonjs/node-loggly.git"},scripts:{pretest:"common lib/**/*.js lib/*.js test/helpers.js",test:"vows test/*-test.js --spec"},version:"1.1.1"}},function(e,t){e.exports={_from:"logs-to-logentries@^1.0.0",_id:"logs-to-logentries@1.0.0",_inBundle:!1,_integrity:"sha1-MqIP1ixcY9ZC2uqRI6FoQfX3/pA=",_location:"/logs-to-logentries",_phantomChildren:{async:"2.1.2",bl:"1.0.3",chalk:"1.1.3","combined-stream":"1.0.6",extend:"3.0.1","forever-agent":"0.6.1","is-my-json-valid":"2.17.2","is-typedarray":"1.0.0",isstream:"0.1.2","json-stringify-safe":"5.0.1",jsprim:"1.4.1","mime-types":"2.1.18","oauth-sign":"0.8.2","pinkie-promise":"2.0.1",sshpk:"1.14.1",stringstream:"0.0.5"},_requested:{type:"range",registry:!0,raw:"logs-to-logentries@^1.0.0",name:"logs-to-logentries",escapedName:"logs-to-logentries",rawSpec:"^1.0.0",saveSpec:null,fetchSpec:"^1.0.0"},_requiredBy:["/"],_resolved:"https://registry.npmjs.org/logs-to-logentries/-/logs-to-logentries-1.0.0.tgz",_shasum:"32a20fd62c5c63d642daea9123a16841f5f7fe90",_spec:"logs-to-logentries@^1.0.0",_where:"E:\\Projects\\auth0-logs-to-provider",author:{name:"Richard Seldon",email:"arcseldon@gmail.com"},bugs:{url:"https://github.com/tawawa/logs-to-logentries/issues"},bundleDependencies:!1,dependencies:{async:"^2.0.0-rc.5","json-stringify-safe":"5.0.x",moment:"^2.13.0",request:"2.67.x"},deprecated:!1,description:"A simple logentries log client tool",engines:{node:">= 0.8.0"},homepage:"https://github.com/tawawa/logs-to-logentries#readme",keywords:["logging","logentries"],license:"MIT",main:"./lib/logentries",name:"logs-to-logentries",repository:{type:"git",url:"git+ssh://git@github.com/tawawa/logs-to-logentries.git"},version:"1.0.0"}},function(e,t){e.exports={title:"Auth0 Logs to Provider",name:"auth0-logs-to-provider",version:"0.1.0",author:"auth0",description:"This extension will take all of your Auth0 logs and export them to any provider",type:"cron",category:"log_export",initialUrlPath:"/login",logoUrl:"https://cdn.auth0.com/extensions/auth0-logs-to-azure-blob-storage/assets/logo.svg",repository:"https://github.com/auth0-extensions/auth0-logs-to-provider",keywords:["auth0","extension"],schedule:"0 */5 * * * *",auth0:{createClient:!0,onUninstallPath:"/.extensions/on-uninstall",scopes:"read:logs delete:clients"},secrets:{BATCH_SIZE:{description:"The amount of logs to batch before sending to Cloudwatch. A single cron execution will send multiple batches.",default:100},START_FROM:{description:"Checkpoint ID of log to start from."},SLACK_INCOMING_WEBHOOK_URL:{description:"Slack Incoming Webhook URL used to report statistics and possible failures"},SLACK_SEND_SUCCESS:{description:"This setting will enable verbose notifications to Slack which are useful for troubleshooting",type:"select",allowMultiple:!1,default:"false",options:[{value:"false",text:"No"},{value:"true",text:"Yes"}]},LOG_LEVEL:{description:"This allows you to specify the log level of events that need to be sent",type:"select",allowMultiple:!0,options:[{value:"-",text:""},{value:"0",text:"Debug"},{value:"1",text:"Info"},{value:"2",text:"Warning"},{value:"3",text:"Error"},{value:"4",text:"Critical"}]},LOG_TYPES:{description:"If you only want to send events with a specific type (eg: failed logins)",type:"select",allowMultiple:!0,options:[{text:"",value:"-"},{text:"Success Login",value:"s"},{text:"Success Silent Auth",value:"ssa"},{text:"Failed Silent Auth",value:"fsa"},{text:"Success Exchange",value:"seacft"},{text:"Failed Exchange",value:"feacft"},{text:"Success Exchange",value:"seccft"},{text:"Failed Exchange",value:"feccft"},{text:"Success Exchange",value:"sepft"},{text:"Failed Exchange",value:"fepft"},{text:"Success Exchange",value:"sertft"},{text:"Failed Exchange",value:"fertft"},{text:"Success Exchange",value:"seoobft"},{text:"Failed Exchange",value:"feoobft"},{text:"Success Exchange",value:"seotpft"},{text:"Failed Exchange",value:"feotpft"},{text:"Success Exchange",value:"sercft"},{text:"Failed Exchange",value:"fercft"},{text:"Failed Login",value:"f"},{text:"Warning",value:"w"},{text:"Deprecation Notice",value:"depnote"},{text:"Deleted User",value:"du"},{text:"Failed Login (invalid email/username)",value:"fu"},{text:"Failed Login (wrong password)",value:"fp"},{text:"Failed by Connector",value:"fc"},{text:"Failed by CORS",value:"fco"},{text:"Connector Online",value:"con"},{text:"Connector Offline",value:"coff"},{text:"Failed Connector Provisioning",value:"fcpro"},{text:"Success Signup",value:"ss"},{text:"Failed Signup",value:"fs"},{text:"Code Sent",value:"cs"},{text:"Code/Link Sent",value:"cls"},{text:"Success Verification Email",value:"sv"},{text:"Failed Verification Email",value:"fv"},{text:"Success Change Password",value:"scp"},{text:"Failed Change Password",value:"fcp"},{text:"Success Post Change Password Hook",value:"scph"},{text:"Failed Post Change Password Hook",value:"fcph"},{text:"Success Change Email",value:"sce"},{text:"Failed Change Email",value:"fce"},{text:"Success Change Username",value:"scu"},{text:"Failed Change Username",value:"fcu"},{text:"Success Change Phone Number",value:"scpn"},{text:"Failed Change Phone Number",value:"fcpn"},{text:"Success Verification Email Request",value:"svr"},{text:"Failed Verification Email Request",value:"fvr"},{text:"Success Change Password Request",value:"scpr"},{text:"Failed Change Password Request",value:"fcpr"},{text:"Failed Sending Notification",value:"fn"},{text:"API Operation",value:"sapi"},{text:"Failed API Operation",value:"fapi"},{text:"Blocked Account",value:"limit_wc"},{text:"Blocked IP Address",value:"limit_mu"},{text:"Too Many Calls to /userinfo",value:"limit_ui"},{text:"Rate Limit On API",value:"api_limit"},{text:"Too Many Calls to /delegation",value:"limit_delegation"},{text:"Successful User Deletion",value:"sdu"},{text:"Failed User Deletion",value:"fdu"},{text:"Auth0 Update Launched",value:"admin_update_launch"},{text:"Auth0 OS Update Started",value:"sys_os_update_start"},{text:"Auth0 OS Update Ended",value:"sys_os_update_end"},{text:"Auth0 Update Started",value:"sys_update_start"},{text:"Auth0 Update Ended",value:"sys_update_end"},{text:"Success Logout",value:"slo"},{text:"Failed Logout",value:"flo"},{text:"Success Delegation",value:"sd"},{text:"Failed Delegation",value:"fd"},{text:"Unenroll device account",value:"gd_unenroll"},{text:"Update device account",value:"gd_update_device_account"},{text:"Module switch",value:"gd_module_switch"},{text:"Guardian tenant update",value:"gd_tenant_update"},{text:"Second factor started",value:"gd_start_auth"},{text:"Enroll started",value:"gd_start_enroll"},{text:"MFA Enrollment start failed",value:"gd_start_enroll_failed"},{text:"User delete",value:"gd_user_delete"},{text:"OTP Auth suceed",value:"gd_auth_succeed"},{text:"OTP Auth failed",value:"gd_auth_failed"},{text:"Push notification sent",value:"gd_send_pn"},{text:"Error sending MFA Push Notification",value:"gd_send_pn_failure"},{text:"OTP Auth rejected",value:"gd_auth_rejected"},{text:"Recovery succeed",value:"gd_recovery_succeed"},{text:"Recovery failed",value:"gd_recovery_failed"},{text:"SMS Sent",value:"gd_send_sms"},{text:"Error sending MFA SMS",value:"gd_send_sms_failure"},{text:"Too many failures",value:"gd_otp_rate_limit_exceed"},{text:"Too many failures",value:"gd_recovery_rate_limit_exceed"},{text:"Guardian enrollment complete",value:"gd_enrollment_complete"},{text:"Users import",value:"fui"},{text:"Users import",value:"sui"},{text:"Breached password",value:"pwd_leak"},{text:"Failed cross origin authentication",value:"fcoa"},{text:"Success cross origin authentication",value:"scoa"},{text:"Account unblocked",value:"ublkdu"}]},PROVIDER:{description:"Select Provider for logs exporting",type:"select",required:!0,allowMultiple:!1,options:[{value:"",text:"Select Provider"},{value:"appinsights",text:"Application Insights"},{value:"blobstorage",text:"Azure Blob Storage"},{value:"cloudwatch",text:"CloudWatch"},{value:"logentries",text:"Logentries"},{value:"loggly",text:"Loggly"},{value:"logstash",text:"Logstash"},{value:"mixpanel",text:"Mixpanel"},{value:"papertrail",text:"Papertrail"},{value:"segment",text:"Segment"},{value:"splunk",text:"Splunk"},{value:"sumologic",text:"Sumologic"}]},APPINSIGHTS_INSTRUMENTATIONKEY:{visibleIf:{PROVIDER:"appinsights"},description:"Application Insights instrumentationKey",required:!0},STORAGE_ACCOUNT_NAME:{visibleIf:{PROVIDER:"blobstorage"},description:"Azure Storage Account Name",required:!0},STORAGE_ACCOUNT_KEY:{visibleIf:{PROVIDER:"blobstorage"},description:"Azure Storage Account Key",required:!0},STORAGE_CONTAINER_NAME:{visibleIf:{PROVIDER:"blobstorage"},description:"Azure Blob Storage Container Name",required:!0},CLOUDWATCH_LOG_GROUP_NAME:{visibleIf:{PROVIDER:"cloudwatch"},description:"Cloudwatch Log Group Name",required:!0},CLOUDWATCH_LOG_STREAM_NAME:{visibleIf:{PROVIDER:"cloudwatch"},description:"Cloudwatch Log Group Stream Name",required:!0},AWS_ACCESS_KEY_ID:{visibleIf:{PROVIDER:"cloudwatch"},description:"AWS Access Key Id Host",required:!0},AWS_SECRET_KEY:{visibleIf:{PROVIDER:"cloudwatch"},description:"AWS Secret Key",required:!0},AWS_REGION:{visibleIf:{PROVIDER:"cloudwatch"},description:"AWS Region",required:!0},LOGENTRIES_TOKEN:{visibleIf:{PROVIDER:"logentries"},description:"Logentries Token",required:!0},LOGGLY_CUSTOMER_TOKEN:{visibleIf:{PROVIDER:"loggly"},description:"Loggly customer token",required:!0,type:"password"},LOGGLY_SUBDOMAIN:{visibleIf:{PROVIDER:"loggly"},description:"Loggly subdomain"},LOGSTASH_URL:{visibleIf:{PROVIDER:"logstash"},description:"Logstash URL (from logstash-input-http)",required:!0},LOGSTASH_INDEX:{visibleIf:{PROVIDER:"logstash"},description:"Logstash Index (as defined in Logstash setup)",required:!0},LOGSTASH_TOKEN:{visibleIf:{PROVIDER:"logstash"},description:"Logstash Token (optional)",type:"password"},LOGSTASH_USER:{visibleIf:{PROVIDER:"logstash"},description:"Logstash User (optional)"},LOGSTASH_PASSWORD:{visibleIf:{PROVIDER:"logstash"},description:"Logstash Password (optional)",type:"password"},MIXPANEL_TOKEN:{visibleIf:{PROVIDER:"mixpanel"},description:"Mixpanel Token - this is your Mixpanel Token for your mixpanel project",required:!0},MIXPANEL_KEY:{visibleIf:{PROVIDER:"mixpanel"},description:"Mixpanel Key - this is your Mixpanel Key for your mixpanel project",required:!0,type:"password"},PAPERTRAIL_HOST:{visibleIf:{PROVIDER:"papertrail"},description:"Papertrail Host",required:!0},PAPERTRAIL_PORT:{visibleIf:{PROVIDER:"papertrail"},description:"Papertrail Port",required:!0},PAPERTRAIL_SYSTEM:{visibleIf:{PROVIDER:"papertrail"},description:"Papertrail System",default:"auth0-logs"},SEGMENT_KEY:{visibleIf:{PROVIDER:"segment"},description:"Segment API Key",required:!0},SPLUNK_URL:{visibleIf:{PROVIDER:"splunk"},description:"Splunk URL - this is your Splunk HTTP Collector Endpoint",required:!0},SPLUNK_TOKEN:{visibleIf:{PROVIDER:"splunk"},description:"Splunk Token - this is your Splunk Token",required:!0,type:"password"},SPLUNK_COLLECTOR_PORT:{visibleIf:{PROVIDER:"splunk"},description:"HTTP Collector Port",required:!0,default:8088},SPLUNK_COLLECTOR_PATH:{visibleIf:{PROVIDER:"splunk"},description:"HTTP Collector Path (Endpoint)",required:!1,default:"/services/collector/event/1.0"},SUMOLOGIC_URL:{visibleIf:{PROVIDER:"sumologic"},description:"Sumo Logic URL - this is your Sumo Logic HTTP Collector Endpoint",required:!0}}}},function(e,t){function r(e){this.message=e}function n(e){var t=String(e).replace(/=+$/,"");if(t.length%4==1)throw new r("'atob' failed: The string to be decoded is not correctly encoded.");for(var n,i,s=0,a=0,u="";i=t.charAt(a++);~i&&(n=s%4?64*n+i:i,s++%4)?u+=String.fromCharCode(255&n>>(-2*s&6)):0)i=o.indexOf(i);return u}var o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";r.prototype=new Error,r.prototype.name="InvalidCharacterError",e.exports="undefined"!=typeof window&&window.atob&&window.atob.bind(window)||n},function(e,t,r){function n(e){return decodeURIComponent(o(e).replace(/(.)/g,function(e,t){var r=t.charCodeAt(0).toString(16).toUpperCase();return r.length<2&&(r="0"+r),"%"+r}))}var o=r(104);e.exports=function(e){var t=e.replace(/-/g,"+").replace(/_/g,"/");switch(t.length%4){case 0:break;case 2:t+="==";break;case 3:t+="=";break;default:throw"Illegal base64url string!"}try{return n(t)}catch(e){return o(t)}}},function(e,t,r){"use strict";function n(e){var t;try{t=JSON.stringify(e)}catch(r){t=u(e,null,null,noop)}return t}var o=r(21),i=r(5),s=r(107),a=r(20),u=r(29);t.createClient=function(e){return new c(e)};var c=t.Logentries=function(e){if(!e||!e.url)throw new Error("options.url is required.");o.EventEmitter.call(this),this.url=e.url,this.json=e.json||null,this.auth=e.auth||null,this.proxy=e.proxy||null,this.userAgent="logs-to-logentries "+a.version};i.inherits(c,o.EventEmitter),c.prototype.log=function(e,t){function r(e){return e instanceof Object?i.json?n(e):s.serialize(e):i.json?n({message:e}):e}var o,i=this,a=Array.isArray(e);if(a)throw Error("Bulk not supported at this time due to restrictions on POST size limit by logentries");return e=a?e.map(r).join("\n"):r(e),e=r(e),o={uri:this.url,method:"POST",body:e,proxy:this.proxy,headers:{host:this.host,accept:"*/*","user-agent":this.userAgent,"content-type":this.json?"application/json":"text/plain","content-length":Buffer.byteLength(e)}},s.logentries(o,t,function(e,r){try{var n="";if(r)try{n=JSON.parse(r)}catch(e){console.error(e)}i.emit("log",n),t&&t(null,n)}catch(e){t&&t(new Error("Unspecified error from Logentries: "+e))}}),this}},function(e,t,r){var n=(r(35),r(5),r(12)),o=(r(20),t),i=o.failCodes={400:"Bad Request",401:"Unauthorized",403:"Forbidden",404:"Not Found",409:"Conflict / Duplicate",410:"Gone",500:"Internal Server Error",501:"Not Implemented",503:"Throttled"};o.logentries=function(){function e(e){t||(t=!0,f&&f(e))}var t,r,o,s,a,u,c,l=Array.prototype.slice.call(arguments),p=l.pop(),f=l.pop();1===l.length?"string"==typeof l[0]?(s="GET",c=l[0]):(s=l[0].method||"GET",c=l[0].uri,r=l[0].body,a=l[0].auth,o=l[0].headers,u=l[0].proxy):2===l.length?(s="GET",c=l[0],a=l[1]):(s=l[0],c=l[1],a=l[2]);var d={uri:c,method:s,headers:o||{},proxy:u};a&&(d.headers.authorization="Basic "+new Buffer(a.username+":"+a.password).toString("base64")),r&&(d.body=r);try{n(d,function(t,r,n){if(t)return e(t);var o=r.statusCode.toString();if(-1!==Object.keys(i).indexOf(o))return e(new Error("Logentries Error ("+o+")"));p(r,n)})}catch(t){e(t)}},o.serialize=function(e,t){if(null===e?e="null":void 0===e?e="undefined":!1===e&&(e="false"),"object"!=typeof e)return t?t+"="+e:e;for(var r="",n=Object.keys(e),i=n.length,s=0;s<i;s++){if(Array.isArray(e[n[s]])){r+=n[s]+"=[";for(var a=0,u=e[n[s]].length;a<u;a++)r+=o.serialize(e[n[s]][a]),a<u-1&&(r+=", ");r+="]"}else r+=o.serialize(e[n[s]],n[s]);s<i-1&&(r+=", ")}return r},o.clone=function(e){var t={};for(var r in e)t[r]=e[r]instanceof Object?o.clone(e[r]):e[r];return t}},function(e,t,r){function n(e){var t=function(){return t.called?t.value:(t.called=!0,t.value=e.apply(this,arguments))};return t.called=!1,t}function o(e){var t=function(){if(t.called)throw new Error(t.onceError);return t.called=!0,t.value=e.apply(this,arguments)},r=e.name||"Function wrapped with `once`";return t.onceError=r+" shouldn't be called more than once",t.called=!1,t}var i=r(132);e.exports=i(n),e.exports.strict=i(o),n.proto=n(function(){Object.defineProperty(Function.prototype,"once",{value:function(){return n(this)},configurable:!0}),Object.defineProperty(Function.prototype,"onceStrict",{value:function(){return o(this)},configurable:!0})})},function(e,t,r){var n=r(110),o=r(33);e.exports={Logger:n,utils:o}},function(e,t,r){function n(e,t){console.log("ERROR:",e," CONTEXT",t)}function o(e,t){return{message:e,severity:t}}var i=r(12),s=r(13),a=r(33),u=function(e){this._timerID=null,this._timerDuration=0,this.config=this._initializeConfig(e),this.requestOptions=this._initializeRequestOptions(),this.serializedContextQueue=[],this.eventsBatchSize=0,this.eventFormatter=o,this.error=n,this._enableTimer=a.bind(this,this._enableTimer),this._disableTimer=a.bind(this,this._disableTimer),this._initializeConfig=a.bind(this,this._initializeConfig),this._initializeRequestOptions=a.bind(this,this._initializeRequestOptions),this._validateMessage=a.bind(this,this._validateMessage),this._initializeMetadata=a.bind(this,this._initializeMetadata),this._initializeContext=a.bind(this,this._initializeContext),this._makeBody=a.bind(this,this._makeBody),this._post=a.bind(this,this._post),this._sendEvents=a.bind(this,this._sendEvents),this.send=a.bind(this,this.send),this.flush=a.bind(this,this.flush)};u.prototype.levels={DEBUG:"debug",INFO:"info",WARN:"warn",ERROR:"error"};var c={name:"splunk-javascript-logging/0.9.3",host:"localhost",path:"/services/collector/event/1.0",protocol:"https",port:8088,level:u.prototype.levels.INFO,maxRetries:0,batchInterval:0,maxBatchSize:0,maxBatchCount:1},l={json:!1,strictSSL:!1};u.prototype._disableTimer=function(){this._timerID&&(clearInterval(this._timerID),this._timerDuration=0,this._timerID=null)},u.prototype._enableTimer=function(e){e=a.validateNonNegativeInt(e,"Batch interval"),this._timerID&&this._disableTimer(),this.config&&(this.config.batchInterval=e),this._timerDuration=e;var t=this;this._timerID=setInterval(function(){t.serializedContextQueue.length>0&&t.flush()},e)},u.prototype._initializeConfig=function(e){var t=a.copyObject(this.config);if(!e)throw new Error("Config is required.");if("object"!=typeof e)throw new Error("Config must be an object.");if(!t.hasOwnProperty("token")&&!e.hasOwnProperty("token"))throw new Error("Config object must have a token.");if("string"!=typeof t.token&&"string"!=typeof e.token)throw new Error("Config token must be a string.");if(e.url){var r=s.parse(e.url),n=r.path&&"/"!==r.path;r.protocol&&(e.protocol=r.protocol.replace(":","")),r.port&&(e.port=r.port),r.hostname&&r.path?(e.host=r.hostname,n&&(e.path=r.path)):n&&(e.host=r.path)}if(t.token=a.orByProp("token",e,t),t.name=a.orByProp("name",e,t,c),t.level=a.orByProp("level",e,t,c),t.host=a.orByProp("host",e,t,c),t.path=a.orByProp("path",e,t,c),t.protocol=a.orByProp("protocol",e,t,c),t.port=a.orByFalseyProp("port",e,t,c),t.port=a.validateNonNegativeInt(t.port,"Port"),t.port<1||t.port>65535)throw new Error("Port must be an integer between 1 and 65535, found: "+t.port);t.maxRetries=a.orByProp("maxRetries",e,t,c),t.maxRetries=a.validateNonNegativeInt(t.maxRetries,"Max retries"),t.maxBatchCount=a.orByFalseyProp("maxBatchCount",e,t,c),t.maxBatchCount=a.validateNonNegativeInt(t.maxBatchCount,"Max batch count"),t.maxBatchSize=a.orByFalseyProp("maxBatchSize",e,t,c),t.maxBatchSize=a.validateNonNegativeInt(t.maxBatchSize,"Max batch size"),t.batchInterval=a.orByFalseyProp("batchInterval",e,t,c),t.batchInterval=a.validateNonNegativeInt(t.batchInterval,"Batch interval");var o=!this._timerID&&t.batchInterval>0,i=this._timerID&&this._timerDuration!==t.batchInterval&&t.batchInterval>0;return o||i?this._enableTimer(t.batchInterval):this._timerID&&(t.batchInterval<=0||this._timerDuration<0)&&this._disableTimer(),t},u.prototype._initializeRequestOptions=function(e){var t=a.copyObject(e||l);return e&&(t.json=e.hasOwnProperty("json")?e.json:l.json,t.strictSSL=e.strictSSL||l.strictSSL),t.headers=t.headers||{},t},u.prototype._validateMessage=function(e){if(void 0===e||null===e)throw new Error("Message argument is required.");return e},u.prototype._initializeMetadata=function(e){var t={};return e&&e.hasOwnProperty("metadata")&&(e.metadata.hasOwnProperty("time")&&(t.time=e.metadata.time),e.metadata.hasOwnProperty("host")&&(t.host=e.metadata.host),e.metadata.hasOwnProperty("source")&&(t.source=e.metadata.source),e.metadata.hasOwnProperty("sourcetype")&&(t.sourcetype=e.metadata.sourcetype),e.metadata.hasOwnProperty("index")&&(t.index=e.metadata.index)),t},u.prototype._initializeContext=function(e){if(!e)throw new Error("Context argument is required.");if("object"!=typeof e)throw new Error("Context argument must be an object.");if(!e.hasOwnProperty("message"))throw new Error("Context argument must have the message property set.");return e.message=this._validateMessage(e.message),e.severity=e.severity||c.level,e.metadata=e.metadata||this._initializeMetadata(e),e},u.prototype._makeBody=function(e){if(!e)throw new Error("Context parameter is required.");var t=this._initializeMetadata(e),r=a.formatTime(t.time||Date.now());return t.time=r.toString(),t.event=this.eventFormatter(e.message,e.severity||c.level),t},u.prototype._post=function(e,t){i.post(e,t)},u.prototype._sendEvents=function(e,t){t=t||function(){},this.config=this._initializeConfig(this.config);var r=this._initializeRequestOptions(this.requestOptions);r.body=this._validateMessage(e.message),r.headers.Authorization="Splunk "+this.config.token,r.headers["Content-Type"]="application/x-www-form-urlencoded",r.url=this.config.protocol+"://"+this.config.host+":"+this.config.port+this.config.path,e=this._initializeContext(e);var n=this,o=null,i=null,s=null,u=null,c=0;a.whilst(function(){return c++<=n.config.maxRetries},function(e){n._post(r,function(t,r,l){if(o=null,i=t,s=r,i&&c<=n.config.maxRetries)return a.expBackoff({attempt:c},e);if(i)return e(t);try{u=JSON.parse(l)}catch(t){u=l,o=new Error("Unexpected response from Splunk. Request body was: "+u),o.code=-1}!o&&u&&u.code&&"0"!==u.code.toString()&&(o=new Error(u.text),o.code=u.code),e(!0)})},function(){(i||o)&&n.error(i||o,e),t(i,s,u)})},u.prototype.send=function(e,t){e=this._initializeContext(e);var r=JSON.stringify(this._makeBody(e));this.serializedContextQueue.push(r),this.eventsBatchSize+=Buffer.byteLength(r,"utf8");var n=this.eventsBatchSize>this.config.maxBatchSize&&this.config.maxBatchSize>0,o=this.serializedContextQueue.length>=this.config.maxBatchCount&&this.config.maxBatchCount>0;(n||o)&&this.flush(t||function(){})},u.prototype.flush=function(e){e=e||function(){};var t=this.serializedContextQueue;this.serializedContextQueue=[],this.eventsBatchSize=0;var r=t.join(""),n={message:r};this._sendEvents(n,e)},e.exports=u},function(e,t){function r(e){return e&&!isNaN(parseFloat(e))&&isFinite(e)}function n(e,t,r){var n=r.current,o=r.next,i=r.max,s=e>0?Math.floor:Math.ceil;return e&&(t[o]+=s.call(null,e/i),t[n]+=e%i),Math.abs(t[n])>=i&&(t[o]+=s.call(null,t[n]/i),t[n]=t[n]%i),t}function o(e,t){return(t%100!=0&&t%4==0||t%400==0)&&1===e?29:l[e]}var i=/^(\d+):(\d+):(\d+):(\d+)(\.\d+)?/,s=/^(\d+):(\d+):(\d+)(\.\d+)?/,a=t.TimeSpan=function(e,t,n,o,i){this.msecs=0,r(i)&&(this.msecs+=864e5*i),r(o)&&(this.msecs+=36e5*o),r(n)&&(this.msecs+=6e4*n),r(t)&&(this.msecs+=1e3*t),r(e)&&(this.msecs+=e)};t.fromMilliseconds=function(e){if(r(e))return new a(e,0,0,0,0)},t.fromSeconds=function(e){if(r(e))return new a(0,e,0,0,0)},t.fromMinutes=function(e){if(r(e))return new a(0,0,e,0,0)},t.fromHours=function(e){if(r(e))return new a(0,0,0,e,0)},t.fromDays=function(e){if(r(e))return new a(0,0,0,0,e)},t.parse=function(e){function t(e){return e?1e3*parseFloat("0"+e):0}var r;return(r=e.match(i))?new a(t(r[5]),r[4],r[3],r[2],r[1]):(r=e.match(s))?new a(t(r[4]),r[3],r[2],r[1],0):null};var u={milliseconds:{exp:/(\d+)milli(?:second)?[s]?/i,compute:function(e,t){return n(e,t,{current:"milliseconds",next:"seconds",max:1e3})}},seconds:{exp:/(\d+)second[s]?/i,compute:function(e,t){return n(e,t,{current:"seconds",next:"minutes",max:60})}},minutes:{exp:/(\d+)minute[s]?/i,compute:function(e,t){return n(e,t,{current:"minutes",next:"hours",max:60})}},hours:{exp:/(\d+)hour[s]?/i,compute:function(e,t){return n(e,t,{current:"hours",next:"days",max:24})}},days:{exp:/(\d+)day[s]?/i,compute:function(e,t){function r(e){return e<0?(t.years-=1,11):e>11?(t.years+=1,0):e}var n=o(t.months,t.years),i=e>=0?1:-1,s=e>=0?-1:1,a=0;if(e){for(;Math.abs(e)>=n;)t.months+=1*i,t.months=r(t.months),e+=s*n,n=o(t.months,t.years);t.days+=s*e}return t.days<0?a=-1:t.days>l[t.months]&&(a=1),-1!==a&&1!==a||(t.months+=a,t.months=r(t.months),t.days=l[t.months]+t.days),t}},months:{exp:/(\d+)month[s]?/i,compute:function(e,t){var r=e>0?Math.floor:Math.ceil;return e&&(t.years+=r.call(null,e/12),t.months+=e%12),t.months>11&&(t.years+=Math.floor((t.months+1)/12),t.months=(t.months+1)%12-1),t}},years:{exp:/(\d+)year[s]?/i,compute:function(e,t){return e&&(t.years+=e),t}}},c=Object.keys(u);t.parseDate=function(e){var t,r,n,o=Date.parse(e),i="Z([\\+|\\-])?",s={};if(!isNaN(o))return new Date(o);if(c.forEach(function(e){i+="(\\d+[a-zA-Z]+)?"}),/^NOW/i.test(e)?(o=Date.now(),i=i.replace(/Z/,"NOW")):/^\-/.test(e)||/^\+/.test(e)?(o=Date.now(),i=i.replace(/Z/,"")):(o=e.match(new RegExp("^([^Z]+)","i")),o=Date.parse(o[1])),!o||!(r=e.match(new RegExp(i,"i"))))return null;o=new Date(o),n="+"===r[1]?1:-1;var t={milliseconds:o.getMilliseconds(),seconds:o.getSeconds(),minutes:o.getMinutes(),hours:o.getHours(),days:o.getDate(),months:o.getMonth(),years:o.getFullYear()};return r.slice(2).filter(Boolean).forEach(function(e){c.forEach(function(t){var r;(r=e.match(u[t].exp))&&(s[t]=n*parseInt(r[1],10))})}),c.forEach(function(e){t=u[e].compute(s[e],t)}),new Date(t.years,t.months,t.days,t.hours,t.minutes,t.seconds,t.milliseconds)},t.fromDates=function(e,r,n){if("string"==typeof e&&(e=t.parseDate(e)),"string"==typeof r&&(r=t.parseDate(r)),!(e instanceof Date&&r instanceof Date))return null;var o=r.valueOf()-e.valueOf();return n&&(o=Math.abs(o)),new a(o,0,0,0,0)},t.test=function(e){return i.test(e)||s.test(e)},t.instanceOf=function(e){return e instanceof a},t.clone=function(e){if(e instanceof a)return t.fromMilliseconds(e.totalMilliseconds())},a.prototype.add=function(e){e instanceof a&&(this.msecs+=e.totalMilliseconds())},a.prototype.addMilliseconds=function(e){r(e)&&(this.msecs+=e)},a.prototype.addSeconds=function(e){r(e)&&(this.msecs+=1e3*e)},a.prototype.addMinutes=function(e){r(e)&&(this.msecs+=6e4*e)},a.prototype.addHours=function(e){r(e)&&(this.msecs+=36e5*e)},a.prototype.addDays=function(e){r(e)&&(this.msecs+=864e5*e)},a.prototype.subtract=function(e){e instanceof a&&(this.msecs-=e.totalMilliseconds())},a.prototype.subtractMilliseconds=function(e){r(e)&&(this.msecs-=e)},a.prototype.subtractSeconds=function(e){r(e)&&(this.msecs-=1e3*e)},a.prototype.subtractMinutes=function(e){r(e)&&(this.msecs-=6e4*e)},a.prototype.subtractHours=function(e){r(e)&&(this.msecs-=36e5*e)},a.prototype.subtractDays=function(e){r(e)&&(this.msecs-=864e5*e)},a.prototype.totalMilliseconds=function(e){var t=this.msecs;return!0===e&&(t=Math.floor(t)),t},a.prototype.totalSeconds=function(e){var t=this.msecs/1e3;return!0===e&&(t=Math.floor(t)),t},a.prototype.totalMinutes=function(e){var t=this.msecs/6e4;return!0===e&&(t=Math.floor(t)),t},a.prototype.totalHours=function(e){var t=this.msecs/36e5;return!0===e&&(t=Math.floor(t)),t},a.prototype.totalDays=function(e){var t=this.msecs/864e5;return!0===e&&(t=Math.floor(t)),t},a.prototype.__defineGetter__("milliseconds",function(){return this.msecs%1e3}),a.prototype.__defineGetter__("seconds",function(){return Math.floor(this.msecs/1e3)%60}),a.prototype.__defineGetter__("minutes",function(){return Math.floor(this.msecs/6e4)%60}),a.prototype.__defineGetter__("hours",function(){return Math.floor(this.msecs/36e5)%24}),a.prototype.__defineGetter__("days",function(){return Math.floor(this.msecs/864e5)}),a.prototype.equals=function(e){if(e instanceof a)return this.msecs===e.totalMilliseconds()},a.prototype.toString=function(){return this.format?this.format(this):this._format()},a.prototype._format=function(){return[this.days,this.hours,this.minutes,this.seconds+"."+this.milliseconds].join(":")};var l=[31,28,31,30,31,30,31,31,30,31,30,31]},function(e,t,r){var n=r(128),o=r(126),i=r(130),s=r(98).Produce,a=r(5),u=r(22),c=t.Papertrail=function(e){function t(){p._erroring=!0;try{p.socket&&(p.socket.destroy(),p.socket=null)}catch(e){}try{p.stream&&(p.stream.removeListener("end",a),p.stream.removeListener("error",c),p.stream.destroy(),p.stream=null)}catch(e){}p._erroring=!1}function r(){p.stream.once("error",c),p.stream.once("end",a)}function a(){if(!p._shutdown&&!p._erroring){t();try{if(p.disableTls)p.stream=o.createConnection(p.port,p.host,l),p.stream.setKeepAlive(!0,p._KEEPALIVE_INTERVAL),r();else{var e=o.createConnection(p.port,p.host,function(){e.setKeepAlive(!0,p._KEEPALIVE_INTERVAL),p.stream=i.connect({socket:e,rejectUnauthorized:!1},l),r()});e.on("error",c),p.socket=e}}catch(e){c(e)}}}function c(e){p._erroring=!0,p._silentErrorEmitter(e),setTimeout(function(){p.currentRetries++,p.totalRetries++,p.connectionDelay<p.maxDelayBetweenReconnection&&p.currentRetries>=p.attemptsBeforeDecay&&(p.connectionDelay=2*p.connectionDelay,p.currentRetries=0),p.loggingEnabled&&p.totalRetries>=p.maximumAttempts&&(p.loggingEnabled=!1,p._silentErrorEmitter(new Error("Max entries eclipsed, disabling buffering"))),p._erroring=!1,a()},p.connectionDelay)}function l(){p.loggingEnabled=!0,p.currentRetries=0,p.totalRetries=0,p.connectionDelay=e.connectionDelay||1e3,p.emit("connect","Connected to Papertrail at "+p.host+":"+p.port),p.processBuffer()}var p=this;if(u.Transport.call(p,e),p._KEEPALIVE_INTERVAL=15e3,e=e||{},p.name="Papertrail",p.level=e.level||"info",p.depth=e.depth||null,p.levels=e.levels||{silly:7,debug:7,verbose:7,info:6,warn:4,error:3},p.host=e.host,p.port=e.port,p.disableTls="boolean"==typeof e.disableTls&&e.disableTls,p.hostname=e.hostname||n.hostname(),p.program=e.program||"default",p.facility=e.facility||"daemon",p.colorize=e.colorize||!1,p.logFormat=e.logFormat||function(e,t){return e+" "+t},p.attemptsBeforeDecay=e.attemptsBeforeDecay||5,p.maximumAttempts=e.maximumAttempts||25,p.connectionDelay=e.connectionDelay||1e3,p.handleExceptions=e.handleExceptions||!1,p.maxDelayBetweenReconnection=e.maxDelayBetweenReconnection||6e4,p.maxBufferSize=e.maxBufferSize||1048576,p.inlineMeta=e.inlineMeta||!1,p.flushOnClose=e.flushOnClose||!1,p.producer=new s({facility:p.facility}),p.currentRetries=0,p.totalRetries=0,p.buffer="",p.loggingEnabled=!0,p._shutdown=!1,!p.host||!p.port)throw new Error("Missing required parameters: host and port");a(),p._reconnectStream=a};a.inherits(c,u.Transport),u.transports.Papertrail=c,c.prototype.log=function(e,t,r,n){var o=this;if("function"!=typeof r||n||(n=r,r=!1),r&&"object"==typeof r&&0===Object.keys(r).length&&!a.isError(r)&&(r=!1),!this.loggingEnabled)return n(null,!0);var i=t;"string"!=typeof i&&(i=a.inspect(i,!1,o.depth,o.colorize)),r&&("object"!=typeof r?i+=" "+r:r&&(this.inlineMeta?i+=" "+a.inspect(r,!1,o.depth,o.colorize).replace(/[\n\t]\s*/gm," "):i+="\n"+a.inspect(r,!1,o.depth,o.colorize))),this.sendMessage(this.hostname,this.program,e,i,n)},c.prototype.sendMessage=function(e,t,r,n,o){var i=this,s=[],a="",c="";s=n?n.split("\n"):[""];for(var l=0;l<s.length&&(0!==s[l].length||l!=s.length-1);l++)1==l&&(c="    "),a+=i.producer.produce({severity:i.levels[r]?i.levels[r]:r,host:e,appName:t,date:new Date,message:i.logFormat(i.colorize?u.config.colorize(r):r,c+s[l])})+"\r\n";this.stream&&this.stream.writable?(this.processBuffer(),this.stream.write(a,o)):this.loggingEnabled&&this.buffer.length<this.maxBufferSize&&(this.buffer+=a)},c.prototype.processBuffer=function(){var e=this;this.buffer.length<=0||this.stream&&this.stream.writable&&(this.stream.write(this.buffer,function(){e.buffer.length||e.stream.emit("empty")}),this.buffer="")},c.prototype.close=function(){var e=this;e._shutdown=!0,e.stream?e.flushOnClose&&e.buffer.length?e.stream.on("empty",function(){e.close()}):e.stream.end():e.on("connect",function(){e.close()})},c.prototype._silentErrorEmitter=function(e){this.listeners("error").length>0?this.emit("error",e):console.error("Papertrail connection error: ",e)}},function(e,t){e.exports=require("analytics-node@2.0.1")},function(e,t){e.exports=require("applicationinsights@0.18.0")},function(e,t){e.exports=require("aws-sdk@2.197.0")},function(e,t){e.exports=require("azure-storage@0.9.0")},function(e,t){e.exports=require("body-parser@1.12.4")},function(e,t){e.exports=require("cookie-signature@1.0.6")},function(e,t){e.exports=require("crypto")},function(e,t){e.exports=require("ejs@2.3.1")},function(e,t){e.exports=require("fs")},function(e,t){e.exports=require("jsonwebtoken@7.1.9")},function(e,t){e.exports=require("jwks-rsa@1.1.1")},function(e,t){e.exports=require("mixpanel@0.4.0")},function(e,t){e.exports=require("morgan@1.5.3")},function(e,t){e.exports=require("net")},function(e,t){e.exports=require("node-uuid@1.4.3")},function(e,t){e.exports=require("os")},function(e,t){e.exports=require("superagent@1.2.0")},function(e,t){e.exports=require("tls")},function(e,t){e.exports=require("webtask-tools")},function(e,t){e.exports=require("wrappy@1.0.1")}]);